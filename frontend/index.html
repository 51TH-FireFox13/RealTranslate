<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>RealTranslate - Traduction en Temps Réel</title>

  <!-- PWA Meta Tags -->
  <meta name="description" content="Application de traduction instantanée multilingue avec chat de groupe">
  <meta name="theme-color" content="#00ff9d">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="RealTranslate">
  <link rel="manifest" href="/manifest.json">
  <link rel="apple-touch-icon" href="/icon-192.png">

  <style>
    /* Variables CSS pour les thèmes */
    :root {
      /* Dark theme (default) */
      --bg-gradient-start: #0a0a0a;
      --bg-gradient-end: #1a1a2e;
      --text-primary: #ffffff;
      --text-secondary: #aaaaaa;
      --text-tertiary: #888888;

      --panel-bg: rgba(255, 255, 255, 0.05);
      --panel-border: rgba(255, 255, 255, 0.1);
      --input-bg: rgba(255, 255, 255, 0.08);
      --input-border: rgba(255, 255, 255, 0.1);
      --input-focus-bg: rgba(255, 255, 255, 0.12);

      --button-bg: rgba(0, 0, 0, 0.3);
      --button-border: rgba(255, 255, 255, 0.2);
      --header-bg: rgba(0, 0, 0, 0.3);

      --message-bg-own: #00ff9d;
      --message-text-own: #000000;
      --message-bg-other: rgba(255, 255, 255, 0.1);
      --message-text-other: #ffffff;

      --accent-gradient: linear-gradient(90deg, #00ff9d, #00a2ff);
      --accent-primary: #00ff9d;
      --accent-secondary: #00a2ff;

      --error-bg: rgba(255, 107, 107, 0.2);
      --error-border: rgba(255, 107, 107, 0.5);
      --error-text: #ff6b6b;

      --success-bg: rgba(0, 255, 157, 0.2);
      --success-border: rgba(0, 255, 157, 0.5);
      --success-text: #00ff9d;
    }

    /* Light theme */
    body.light-theme {
      --bg-gradient-start: #f5f7fa;
      --bg-gradient-end: #c3cfe2;
      --text-primary: #1a1a1a;
      --text-secondary: #4a4a4a;
      --text-tertiary: #6a6a6a;

      --panel-bg: rgba(255, 255, 255, 0.9);
      --panel-border: rgba(0, 0, 0, 0.1);
      --input-bg: rgba(0, 0, 0, 0.05);
      --input-border: rgba(0, 0, 0, 0.15);
      --input-focus-bg: rgba(0, 0, 0, 0.08);

      --button-bg: rgba(255, 255, 255, 0.8);
      --button-border: rgba(0, 0, 0, 0.15);
      --header-bg: rgba(255, 255, 255, 0.95);

      --message-bg-own: #00cc7a;
      --message-text-own: #ffffff;
      --message-bg-other: rgba(0, 0, 0, 0.08);
      --message-text-other: #1a1a1a;

      --accent-gradient: linear-gradient(90deg, #00cc7a, #0088cc);
      --accent-primary: #00cc7a;
      --accent-secondary: #0088cc;

      --error-bg: rgba(255, 107, 107, 0.15);
      --error-border: rgba(255, 107, 107, 0.4);
      --error-text: #d63031;

      --success-bg: rgba(0, 184, 148, 0.15);
      --success-border: rgba(0, 184, 148, 0.4);
      --success-text: #00b894;
    }

    /* Color themes - Green/Cyan (default) */
    body.theme-green {
      --accent-gradient: linear-gradient(90deg, #00ff9d, #00a2ff);
      --accent-primary: #00ff9d;
      --accent-secondary: #00a2ff;
      --message-bg-own: #00ff9d;
    }

    body.light-theme.theme-green {
      --accent-gradient: linear-gradient(90deg, #00cc7a, #0088cc);
      --accent-primary: #00cc7a;
      --accent-secondary: #0088cc;
      --message-bg-own: #00cc7a;
    }

    /* Color theme - Blue */
    body.theme-blue {
      --accent-gradient: linear-gradient(90deg, #4da6ff, #0066ff);
      --accent-primary: #4da6ff;
      --accent-secondary: #0066ff;
      --message-bg-own: #4da6ff;
    }

    body.light-theme.theme-blue {
      --accent-gradient: linear-gradient(90deg, #3399ff, #0056d6);
      --accent-primary: #3399ff;
      --accent-secondary: #0056d6;
      --message-bg-own: #3399ff;
    }

    /* Color theme - Purple */
    body.theme-purple {
      --accent-gradient: linear-gradient(90deg, #a855f7, #6366f1);
      --accent-primary: #a855f7;
      --accent-secondary: #6366f1;
      --message-bg-own: #a855f7;
    }

    body.light-theme.theme-purple {
      --accent-gradient: linear-gradient(90deg, #9333ea, #4f46e5);
      --accent-primary: #9333ea;
      --accent-secondary: #4f46e5;
      --message-bg-own: #9333ea;
    }

    /* Color theme - Pink */
    body.theme-pink {
      --accent-gradient: linear-gradient(90deg, #ff6b9d, #ff1f7e);
      --accent-primary: #ff6b9d;
      --accent-secondary: #ff1f7e;
      --message-bg-own: #ff6b9d;
    }

    body.light-theme.theme-pink {
      --accent-gradient: linear-gradient(90deg, #ec4899, #db2777);
      --accent-primary: #ec4899;
      --accent-secondary: #db2777;
      --message-bg-own: #ec4899;
    }

    /* Color theme - Orange */
    body.theme-orange {
      --accent-gradient: linear-gradient(90deg, #ff9f43, #ff6348);
      --accent-primary: #ff9f43;
      --accent-secondary: #ff6348;
      --message-bg-own: #ff9f43;
    }

    body.light-theme.theme-orange {
      --accent-gradient: linear-gradient(90deg, #fb923c, #f97316);
      --accent-primary: #fb923c;
      --accent-secondary: #f97316;
      --message-bg-own: #fb923c;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
      color: var(--text-primary);
      height: 100vh;
      overflow: hidden;
      transition: background 0.3s ease, color 0.3s ease;
    }

    /* Main App Container */
    #mainApp {
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow: hidden;
    }

    /* Login Screen */
    .login-container {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
      z-index: 9999;
    }

    .login-box {
      background: var(--panel-bg);
      backdrop-filter: blur(20px);
      border-radius: 20px;
      padding: 40px;
      width: 90%;
      max-width: 400px;
      border: 1px solid var(--panel-border);
    }

    .login-box h2 {
      text-align: center;
      margin-bottom: 10px;
      background: linear-gradient(90deg, #00ff9d, #00a2ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-size: 2em;
    }

    .login-box p {
      text-align: center;
      color: #888;
      margin-bottom: 30px;
      font-size: 0.9em;
    }

    .input-group {
      margin-bottom: 20px;
    }

    .input-group label {
      display: block;
      margin-bottom: 8px;
      color: var(--text-secondary);
      font-size: 0.9em;
    }

    .input-group input {
      width: 100%;
      padding: 12px 15px;
      background: var(--input-bg);
      border: 1px solid var(--input-border);
      border-radius: 10px;
      color: var(--text-primary);
      font-size: 1em;
      transition: all 0.3s ease;
    }

    .input-group input:focus {
      outline: none;
      border-color: var(--accent-primary);
      background: var(--input-focus-bg);
    }

    .login-btn {
      width: 100%;
      padding: 15px;
      background: var(--accent-gradient);
      border: none;
      border-radius: 10px;
      color: #000;
      font-size: 1.1em;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .login-btn:hover {
      transform: translateY(-2px);
    }

    .login-btn:active {
      transform: translateY(0);
    }

    .login-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .error-message {
      background: var(--error-bg);
      border: 1px solid var(--error-border);
      color: var(--error-text);
      padding: 10px 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 0.9em;
      text-align: center;
    }

    .success-message {
      background: var(--success-bg);
      border: 1px solid var(--success-border);
      color: var(--success-text);
      padding: 10px 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 0.9em;
      text-align: center;
    }

    /* Header */
    header {
      background: var(--header-bg);
      backdrop-filter: blur(10px);
      padding: 20px;
      text-align: center;
      border-bottom: 2px solid var(--panel-border);
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      align-items: center;
      gap: 15px;
    }

    .header-content {
      grid-column: 2;
      text-align: center;
      white-space: nowrap;
    }

    .user-menu {
      justify-self: end;
    }

    .user-menu {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .user-info {
      font-size: 0.85em;
      color: #00ff9d;
      padding: 8px 15px;
      background: rgba(0, 255, 157, 0.1);
      border-radius: 20px;
      border: 1px solid rgba(0, 255, 157, 0.3);
    }

    .logout-btn, .admin-btn {
      background: rgba(255, 107, 107, 0.2);
      border: 1px solid rgba(255, 107, 107, 0.5);
      color: #ff6b6b;
      padding: 8px 15px;
      border-radius: 20px;
      cursor: pointer;
      font-size: 0.85em;
      transition: all 0.3s ease;
    }

    .admin-btn {
      background: rgba(0, 162, 255, 0.2);
      border: 1px solid rgba(0, 162, 255, 0.5);
      color: #00a2ff;
    }

    .profile-btn {
      background: rgba(0, 255, 157, 0.2);
      border: 1px solid rgba(0, 255, 157, 0.5);
      color: #00ff9d;
      padding: 8px 15px;
      border-radius: 20px;
      cursor: pointer;
      font-size: 0.85em;
      transition: all 0.3s ease;
    }

    .logout-btn:hover {
      background: rgba(255, 107, 107, 0.3);
    }

    .admin-btn:hover {
      background: rgba(0, 162, 255, 0.3);
    }

    .profile-btn:hover {
      background: rgba(0, 255, 157, 0.3);
    }

    /* Admin Panel */
    .admin-panel {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.95);
      z-index: 10000;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .admin-content {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px);
      border-radius: 20px;
      padding: 30px;
      width: 100%;
      max-width: 900px;
      max-height: 90vh;
      overflow-y: auto;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .admin-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 2px solid rgba(255, 255, 255, 0.1);
    }

    .admin-header h2 {
      font-size: 1.8em;
      background: linear-gradient(90deg, #00ff9d, #00a2ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .close-admin-btn {
      background: rgba(255, 107, 107, 0.2);
      border: 1px solid rgba(255, 107, 107, 0.5);
      color: #ff6b6b;
      padding: 10px 20px;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .close-admin-btn:hover {
      background: rgba(255, 107, 107, 0.3);
    }

    .admin-section {
      margin-bottom: 30px;
    }

    .admin-section h3 {
      color: #00ff9d;
      margin-bottom: 15px;
      font-size: 1.3em;
    }

    .users-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }

    .users-table th {
      background: rgba(0, 255, 157, 0.1);
      padding: 12px;
      text-align: left;
      border-bottom: 2px solid rgba(0, 255, 157, 0.3);
      color: #00ff9d;
      font-weight: 600;
    }

    .users-table td {
      padding: 12px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .users-table tr:hover {
      background: rgba(255, 255, 255, 0.05);
    }

    .role-badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 0.85em;
      font-weight: 600;
    }

    .role-badge.admin {
      background: rgba(255, 107, 107, 0.2);
      border: 1px solid rgba(255, 107, 107, 0.5);
      color: #ff6b6b;
    }

    .role-badge.user {
      background: rgba(0, 162, 255, 0.2);
      border: 1px solid rgba(0, 162, 255, 0.5);
      color: #00a2ff;
    }

    .role-badge.guest {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: #aaa;
    }

    .delete-user-btn {
      background: rgba(255, 107, 107, 0.2);
      border: 1px solid rgba(255, 107, 107, 0.5);
      color: #ff6b6b;
      padding: 6px 12px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.85em;
      transition: all 0.3s ease;
    }

    .delete-user-btn:hover {
      background: rgba(255, 107, 107, 0.3);
    }

    .delete-user-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .create-user-form {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr auto;
      gap: 10px;
      align-items: end;
    }

    .create-user-form select {
      width: 100%;
      padding: 12px 15px;
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      color: #fff;
      font-size: 1em;
      cursor: pointer;
    }

    .create-user-form select:focus {
      outline: none;
      border-color: #00ff9d;
      background: rgba(255, 255, 255, 0.12);
    }

    .create-user-btn {
      padding: 12px 24px;
      background: linear-gradient(90deg, #00ff9d, #00a2ff);
      border: none;
      border-radius: 10px;
      color: #000;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s ease;
      white-space: nowrap;
    }

    .create-user-btn:hover {
      transform: translateY(-2px);
    }

    .create-user-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .loading-spinner {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-top-color: #00ff9d;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Center Controls (Desktop) */
    .center-controls {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 20px;
      padding: 20px 15px;
      min-width: 140px;
    }

    .center-control-btn {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 255, 255, 0.2);
      color: #fff;
      padding: 15px;
      border-radius: 15px;
      cursor: pointer;
      font-size: 0.85em;
      font-weight: 600;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
      transition: all 0.3s ease;
      width: 100px;
    }

    .center-control-btn .icon {
      font-size: 2em;
    }

    .center-control-btn .label {
      font-size: 0.8em;
    }

    .center-control-btn:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: scale(1.05);
    }

    .center-control-btn.active {
      background: linear-gradient(135deg, #00ff9d, #00a2ff);
      border-color: #00ff9d;
      color: #000;
    }

    .center-control-btn.muted {
      background: rgba(255, 107, 107, 0.2);
      border-color: rgba(255, 107, 107, 0.5);
      color: #ff6b6b;
    }

    .ptt-btn {
      background: linear-gradient(135deg, rgba(255, 107, 107, 0.3), rgba(255, 157, 0, 0.3));
      border: 3px solid #ff6b6b;
      color: #fff;
      padding: 20px;
      border-radius: 20px;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
      transition: all 0.2s ease;
      user-select: none;
      width: 100px;
    }

    .ptt-btn .icon {
      font-size: 2.5em;
    }

    .ptt-btn .label {
      font-size: 0.7em;
      font-weight: 600;
      text-align: center;
      line-height: 1.2;
    }

    .ptt-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 5px 20px rgba(255, 107, 107, 0.4);
    }

    .ptt-btn:active, .ptt-btn.recording {
      transform: scale(0.95);
      background: linear-gradient(135deg, rgba(255, 107, 107, 0.5), rgba(255, 157, 0, 0.5));
    }

    /* Page Indicators (Mobile only) */
    .page-indicators {
      display: none;
      position: fixed;
      bottom: 90px;
      left: 50%;
      transform: translateX(-50%);
      flex-direction: row;
      gap: 8px;
      z-index: 99;
    }

    .page-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .page-dot.active {
      background: var(--accent-primary);
      width: 24px;
      border-radius: 4px;
    }

    /* Mobile Controls (Hidden on desktop) */
    .mobile-controls {
      display: none;
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      flex-direction: row;
      align-items: center;
      gap: 10px;
      z-index: 100;
      background: rgba(0, 0, 0, 0.7);
      backdrop-filter: blur(20px);
      padding: 10px 15px;
      border-radius: 25px;
      border: 2px solid rgba(255, 255, 255, 0.1);
    }

    .mobile-control-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid rgba(255, 255, 255, 0.2);
      color: #fff;
      padding: 12px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1.5em;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      width: 50px;
      height: 50px;
    }

    .mobile-control-btn.active {
      background: linear-gradient(135deg, #00ff9d, #00a2ff);
      border-color: #00ff9d;
    }

    .mobile-control-btn.muted {
      background: rgba(255, 107, 107, 0.2);
      border-color: rgba(255, 107, 107, 0.5);
      color: #ff6b6b;
    }

    .mode-switch-container-mobile {
      display: flex;
      align-items: center;
    }

    .mode-switch-mobile {
      display: flex;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      padding: 5px;
      gap: 5px;
    }

    .mode-switch-mobile .mode-text {
      padding: 8px 12px;
      border-radius: 15px;
      font-size: 0.75em;
      font-weight: 600;
      transition: all 0.3s ease;
      cursor: pointer;
      color: #888;
    }

    .mode-switch-mobile .mode-text:first-child {
      background: transparent;
    }

    .mode-switch-mobile .mode-text:last-child {
      background: linear-gradient(135deg, #00ff9d, #00a2ff);
      color: #000;
    }

    .mode-switch-mobile.push-to-talk .mode-text:first-child {
      background: linear-gradient(135deg, #ff6b6b, #ff9d00);
      color: #fff;
    }

    .mode-switch-mobile.push-to-talk .mode-text:last-child {
      background: transparent;
      color: #888;
    }

    .mobile-ptt-btn {
      background: linear-gradient(135deg, rgba(255, 107, 107, 0.3), rgba(255, 157, 0, 0.3));
      border: 2px solid #ff6b6b;
      color: #fff;
      padding: 12px 20px;
      border-radius: 20px;
      cursor: pointer;
      font-size: 0.9em;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 5px;
      transition: all 0.2s ease;
      user-select: none;
    }

    .mobile-ptt-btn:active, .mobile-ptt-btn.recording {
      transform: scale(0.95);
      background: linear-gradient(135deg, rgba(255, 107, 107, 0.5), rgba(255, 157, 0, 0.5));
    }

    /* Mode Switch */
    .mode-switch-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
    }

    .mode-switch-label {
      font-size: 0.75em;
      color: #888;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .mode-switch {
      position: relative;
      width: 120px;
      height: 50px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 25px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid rgba(255, 255, 255, 0.2);
    }

    .mode-switch::before {
      content: '';
      position: absolute;
      top: 5px;
      left: 5px;
      width: 38px;
      height: 38px;
      background: linear-gradient(135deg, #00ff9d, #00a2ff);
      border-radius: 50%;
      transition: all 0.3s ease;
      box-shadow: 0 2px 10px rgba(0, 255, 157, 0.5);
    }

    .mode-switch.push-to-talk::before {
      left: 75px;
      background: linear-gradient(135deg, #ff6b6b, #ff9d00);
      box-shadow: 0 2px 10px rgba(255, 107, 107, 0.5);
    }

    .mode-switch-text {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      font-size: 0.6em;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.3px;
      transition: all 0.3s ease;
      pointer-events: none;
      white-space: nowrap;
    }

    .mode-switch-text.left {
      left: 5px;
      color: #888;
      opacity: 0;
      visibility: hidden;
    }

    .mode-switch-text.right {
      right: 5px;
      color: #00ff9d;
      opacity: 1;
      visibility: visible;
    }

    .mode-switch.push-to-talk .mode-switch-text.left {
      color: #ff6b6b;
      opacity: 1;
      visibility: visible;
    }

    .mode-switch.push-to-talk .mode-switch-text.right {
      color: #888;
      opacity: 0;
      visibility: hidden;
    }

    /* Push to Talk Button */
    .push-to-talk-btn {
      position: fixed;
      bottom: 150px;
      left: 50%;
      transform: translateX(-50%);
      width: 200px;
      height: 200px;
      border-radius: 50%;
      background: linear-gradient(135deg, rgba(255, 107, 107, 0.3), rgba(255, 157, 0, 0.3));
      border: 3px solid #ff6b6b;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      user-select: none;
      z-index: 99;
      transition: all 0.2s ease;
      box-shadow: 0 10px 40px rgba(255, 107, 107, 0.3);
    }

    .push-to-talk-btn:hover {
      transform: translateX(-50%) scale(1.05);
      box-shadow: 0 15px 50px rgba(255, 107, 107, 0.5);
    }

    .push-to-talk-btn:active, .push-to-talk-btn.recording {
      transform: translateX(-50%) scale(0.95);
      background: linear-gradient(135deg, rgba(255, 107, 107, 0.5), rgba(255, 157, 0, 0.5));
      box-shadow: 0 5px 30px rgba(255, 107, 107, 0.7);
    }

    .push-to-talk-btn .icon {
      font-size: 4em;
      margin-bottom: 10px;
    }

    .push-to-talk-btn .text {
      font-size: 0.9em;
      font-weight: 600;
      color: #fff;
      text-align: center;
    }

    /* Language Selection Screen */
    .language-selection {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
      z-index: 9999;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding: 20px;
      overflow-y: auto;
    }

    .lang-box {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(20px);
      border-radius: 20px;
      padding: 40px;
      width: 90%;
      max-width: 700px;
      max-height: 90vh;
      overflow-y: auto;
      border: 1px solid rgba(255, 255, 255, 0.1);
      text-align: center;
    }

    .lang-box::-webkit-scrollbar {
      width: 8px;
    }

    .lang-box::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
    }

    .lang-box::-webkit-scrollbar-thumb {
      background: rgba(0, 255, 157, 0.3);
      border-radius: 10px;
    }

    .lang-box::-webkit-scrollbar-thumb:hover {
      background: rgba(0, 255, 157, 0.5);
    }

    .lang-box h2 {
      font-size: 2em;
      margin-bottom: 10px;
      background: linear-gradient(90deg, #00ff9d, #00a2ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .lang-box p {
      color: #888;
      margin-bottom: 30px;
      font-size: 1em;
    }

    .lang-step {
      margin-bottom: 40px;
    }

    .lang-step h3 {
      color: #00ff9d;
      margin-bottom: 20px;
      font-size: 1.3em;
    }

    .lang-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .lang-flag {
      background: rgba(255, 255, 255, 0.08);
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 15px;
      padding: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    .lang-flag:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: translateY(-5px);
    }

    .lang-flag.selected {
      background: linear-gradient(135deg, rgba(0, 255, 157, 0.2), rgba(0, 162, 255, 0.2));
      border-color: #00ff9d;
    }

    .lang-flag.suggested {
      border-color: rgba(0, 255, 157, 0.5);
      box-shadow: 0 0 20px rgba(0, 255, 157, 0.3);
    }

    .lang-flag .flag-emoji {
      font-size: 3em;
    }

    .lang-flag .flag-name {
      font-size: 0.9em;
      color: #fff;
      font-weight: 600;
    }

    .lang-continue-btn {
      width: 100%;
      padding: 15px;
      background: linear-gradient(90deg, #00ff9d, #00a2ff);
      border: none;
      border-radius: 10px;
      color: #000;
      font-size: 1.1em;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s ease;
      margin-top: 20px;
    }

    .lang-continue-btn:hover {
      transform: translateY(-2px);
    }

    .lang-continue-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    h1 {
      font-size: 1.8em;
      font-weight: 700;
      background: linear-gradient(90deg, #00ff9d, #00a2ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      font-size: 0.9em;
      color: var(--text-tertiary);
      margin-top: 5px;
    }

    /* Status Bar */
    .status-bar {
      padding: 15px;
      text-align: center;
      font-size: 1.2em;
      font-weight: 600;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .status-bar.listening {
      background: linear-gradient(90deg, #00ff9d, #00d4aa);
      color: #000;
    }

    .status-bar.translating {
      background: linear-gradient(90deg, #ffa500, #ff6b6b);
      color: #fff;
    }

    .status-bar.speaking {
      background: linear-gradient(90deg, #00a2ff, #0077ff);
      color: #fff;
    }

    .status-bar.idle {
      background: rgba(255, 255, 255, 0.1);
      color: #aaa;
    }

    .status-indicator {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: currentColor;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.5; transform: scale(1.2); }
    }

    /* VU-Mètre Micro - Ligne horizontale simple */
    .vu-meter {
      padding: 0;
      height: 3px;
      width: 100%;
      background: rgba(255, 255, 255, 0.1);
      position: relative;
      overflow: hidden;
    }

    .vu-meter.hidden {
      display: none;
    }

    .vu-meter-label {
      display: none;
    }

    .vu-meter-bars {
      display: none;
    }

    .vu-meter-bar {
      display: none;
    }

    /* Nouvelle barre de progression pour vu-mètre horizontal */
    .vu-meter::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: var(--vu-width, 0%);
      background: var(--accent-primary);
      transition: width 0.1s ease;
    }

    .vu-meter.active::before {
      animation: vuPulse 0.3s ease-in-out;
    }

    @keyframes vuPulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    /* Communication Home Styles */
    .communication-home-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
    }

    .comm-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 40px;
      gap: 20px;
    }

    .comm-title-section {
      flex: 1;
      min-width: 0;
    }

    .comm-title {
      font-size: 2.5em;
      margin-bottom: 10px;
      color: var(--text-primary);
    }

    .comm-subtitle {
      color: #888;
      font-size: 1em;
    }

    .comm-header-actions {
      display: flex;
      gap: 15px;
      align-items: center;
      flex-shrink: 0;
    }

    .comm-lang-badge {
      background: rgba(255,255,255,0.05);
      padding: 10px 20px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,0.1);
    }

    .comm-lang-label {
      color: #888;
      font-size: 0.85em;
      margin-bottom: 4px;
    }

    .comm-lang-value {
      color: #00ff9d;
      font-weight: bold;
    }

    .comm-btn {
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.2);
      color: #fff;
      padding: 10px 20px;
      border-radius: 10px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s;
    }

    .comm-btn:hover {
      background: rgba(255,255,255,0.15);
    }

    .comm-avatar {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: linear-gradient(135deg, #00ff9d, #00a2ff);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #000;
      font-weight: bold;
      font-size: 0.9em;
    }

    .comm-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
    }

    .comm-section {
      background: rgba(255,255,255,0.05);
      border-radius: 20px;
      padding: 30px;
      border: 1px solid rgba(255,255,255,0.1);
    }

    .comm-section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      gap: 15px;
    }

    .comm-section-title {
      font-size: 1.5em;
      display: flex;
      align-items: center;
      gap: 10px;
      color: var(--text-primary);
    }

    .comm-action-btn {
      background: #00ff9d;
      color: #000;
      border: none;
      padding: 10px 20px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 8px;
      white-space: nowrap;
      transition: all 0.3s;
    }

    .comm-action-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 15px rgba(0,255,157,0.3);
    }

    .comm-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
      max-height: 500px;
      overflow-y: auto;
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: thin;
      scrollbar-color: rgba(0, 255, 157, 0.3) rgba(255, 255, 255, 0.05);
    }

    .comm-list::-webkit-scrollbar {
      width: 6px;
    }

    .comm-list::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 3px;
    }

    .comm-list::-webkit-scrollbar-thumb {
      background: rgba(0, 255, 157, 0.3);
      border-radius: 3px;
    }

    .comm-list::-webkit-scrollbar-thumb:hover {
      background: rgba(0, 255, 157, 0.5);
    }

    .comm-empty-message {
      color: #888;
      text-align: center;
      padding: 20px 0;
      font-size: 0.95em;
      line-height: 1.5;
    }

    /* Styles pour les items de groupes et DMs */
    .comm-group-item,
    .comm-dm-item {
      position: relative;
      background: rgba(255, 255, 255, 0.08);
      padding: 16px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .comm-group-item:hover,
    .comm-dm-item:hover {
      background: rgba(255, 255, 255, 0.15);
      border-color: rgba(0, 255, 157, 0.3);
    }

    .comm-group-item .group-name {
      color: #fff;
      font-weight: bold;
      font-size: 1.1em;
      margin-bottom: 8px;
    }

    .comm-group-item .group-info {
      color: #888;
      font-size: 0.9em;
      margin-bottom: 4px;
    }

    .comm-group-item .group-date {
      color: #666;
      font-size: 0.85em;
    }

    .comm-dm-item .dm-container {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .comm-dm-item .dm-avatar {
      width: 50px;
      height: 50px;
      flex-shrink: 0;
      position: relative;
    }

    .comm-dm-item .dm-content {
      flex: 1;
      min-width: 0;
    }

    .comm-dm-item .dm-name {
      font-weight: bold;
      color: #fff;
      margin-bottom: 4px;
      display: flex;
      align-items: center;
      font-size: 1.05em;
    }

    .comm-dm-item .dm-message {
      color: #888;
      font-size: 0.9em;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .comm-dm-item .dm-time {
      color: #888;
      font-size: 0.85em;
      white-space: nowrap;
    }

    .comm-quick-actions {
      margin-top: 20px;
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .comm-quick-btn {
      padding: 12px 25px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s;
    }

    .comm-quick-btn-primary {
      background: rgba(100,180,255,0.2);
      border: 2px solid rgba(100,180,255,0.5);
      color: #64b4ff;
    }

    .comm-quick-btn-primary:hover {
      background: rgba(100,180,255,0.3);
      transform: scale(1.05);
    }

    .comm-quick-btn-secondary {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.2);
      color: #fff;
    }

    .comm-quick-btn-secondary:hover {
      background: rgba(255,255,255,0.1);
    }

    /* Responsive Communication Home - Tablet */
    @media (max-width: 968px) {
      .comm-header {
        flex-direction: column;
        align-items: flex-start;
      }

      .comm-header-actions {
        width: 100%;
        justify-content: space-between;
        flex-wrap: wrap;
      }

      .comm-grid {
        grid-template-columns: 1fr;
        gap: 20px;
      }
    }

    /* Responsive Communication Home - Mobile */
    @media (max-width: 768px) {
      .communication-home-container {
        padding: 12px 10px;
      }

      .comm-header {
        margin-bottom: 15px;
      }

      .comm-title {
        font-size: 1.5em;
        margin-bottom: 4px;
      }

      .comm-subtitle {
        display: none; /* Masquer le sous-titre sur mobile */
      }

      .comm-header-actions {
        gap: 8px;
      }

      .comm-lang-badge {
        padding: 6px 10px;
        font-size: 0.9em;
      }

      .comm-lang-label {
        display: none; /* Masquer le label "Langue" */
      }

      .comm-user-name,
      .comm-settings-text {
        display: none;
      }

      .comm-btn {
        padding: 8px;
        min-width: 40px;
      }

      .comm-avatar {
        width: 28px;
        height: 28px;
        font-size: 0.8em;
      }

      .comm-section {
        padding: 12px 10px;
        border-radius: 12px;
      }

      .comm-section-header {
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
        margin-bottom: 12px;
      }

      .comm-section-title {
        font-size: 1.1em;
      }

      .comm-section-title-text {
        display: inline; /* Garder le texte visible pour clarté */
        font-size: 0.9em;
      }

      .comm-action-btn {
        width: auto;
        padding: 8px 12px;
        font-size: 0.85em;
        white-space: nowrap;
      }

      .btn-text {
        display: inline;
      }

      .comm-list {
        max-height: calc(100vh - 420px); /* Hauteur dynamique basée sur viewport */
        min-height: 150px;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch; /* Scroll fluide sur iOS */
        gap: 8px;
      }

      /* Optimisation des items de groupes et DMs sur mobile */
      .comm-group-item,
      .comm-dm-item {
        padding: 12px;
        border-radius: 10px;
      }

      .comm-group-item .group-name {
        font-size: 1em;
        margin-bottom: 6px;
      }

      .comm-group-item .group-info {
        font-size: 0.85em;
      }

      .comm-group-item .group-date {
        font-size: 0.8em;
      }

      .comm-dm-item .dm-container {
        gap: 10px;
      }

      .comm-dm-item .dm-avatar {
        width: 40px;
        height: 40px;
      }

      .comm-dm-item .dm-name {
        font-size: 0.95em;
      }

      .comm-dm-item .dm-message {
        font-size: 0.85em;
      }

      .comm-dm-item .dm-time {
        font-size: 0.8em;
      }

      .comm-quick-actions {
        gap: 8px;
        margin-top: 15px;
      }

      .comm-quick-btn {
        flex: 1;
        min-width: 0;
        padding: 10px 12px;
        font-size: 0.85em;
      }

      .comm-quick-text {
        display: none;
      }
    }

    /* Very Small Mobile */
    @media (max-width: 480px) {
      .communication-home-container {
        padding: 10px 8px;
      }

      .comm-header {
        margin-bottom: 12px;
      }

      .comm-title {
        font-size: 1.3em;
        margin-bottom: 0;
      }

      .comm-title-section {
        margin-bottom: 8px;
      }

      .comm-header-actions {
        flex-direction: row;
        width: 100%;
        gap: 6px;
        flex-wrap: wrap;
      }

      .comm-btn {
        padding: 6px;
        min-width: 36px;
      }

      .comm-avatar {
        width: 24px;
        height: 24px;
        font-size: 0.75em;
      }

      .comm-lang-badge {
        padding: 6px 8px;
        font-size: 0.85em;
        flex: 0 0 auto;
      }

      .comm-section {
        padding: 10px 8px;
        border-radius: 10px;
        margin-bottom: 10px;
      }

      .comm-grid {
        gap: 10px;
      }

      .comm-section-header {
        margin-bottom: 10px;
        gap: 6px;
      }

      .comm-section-title {
        font-size: 1em;
      }

      .comm-section-title-text {
        font-size: 0.85em;
      }

      .comm-action-btn {
        padding: 6px 10px;
        font-size: 0.8em;
      }

      .comm-list {
        max-height: calc(100vh - 380px);
        min-height: 120px;
        gap: 6px;
      }

      /* Optimisation des items pour très petits écrans */
      .comm-group-item,
      .comm-dm-item {
        padding: 10px;
        border-radius: 8px;
      }

      .comm-group-item .group-name {
        font-size: 0.95em;
        margin-bottom: 5px;
      }

      .comm-group-item .group-info {
        font-size: 0.8em;
        margin-bottom: 3px;
      }

      .comm-group-item .group-date {
        font-size: 0.75em;
      }

      .comm-dm-item .dm-container {
        gap: 8px;
      }

      .comm-dm-item .dm-avatar {
        width: 36px;
        height: 36px;
      }

      .comm-dm-item .dm-name {
        font-size: 0.9em;
        margin-bottom: 3px;
      }

      .comm-dm-item .dm-message {
        font-size: 0.8em;
      }

      .comm-dm-item .dm-time {
        font-size: 0.75em;
      }

      .comm-quick-actions {
        flex-direction: row;
        width: 100%;
        gap: 6px;
        margin-top: 12px;
      }

      .comm-quick-btn {
        flex: 1;
        padding: 8px 10px;
        font-size: 0.8em;
      }
    }

    /* Main Container */
    .container {
      flex: 1;
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      gap: 15px;
      padding: 20px;
      overflow: hidden;
      min-height: 0;
    }

    /* Panels */
    .panel {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 20px;
      display: flex;
      flex-direction: column;
      border: 1px solid rgba(255, 255, 255, 0.1);
      overflow: hidden;
      min-height: 0;
    }

    .panel-header {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 2px solid rgba(255, 255, 255, 0.1);
    }

    .panel-header h2 {
      font-size: 1.5em;
      font-weight: 600;
    }

    .flag {
      font-size: 2em;
    }

    .panel-content {
      flex: 1;
      overflow-y: auto;
      padding: 10px;
      scroll-behavior: smooth;
    }

    .panel-content::-webkit-scrollbar {
      width: 8px;
    }

    .panel-content::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
    }

    .panel-content::-webkit-scrollbar-thumb {
      background: rgba(0, 255, 157, 0.3);
      border-radius: 10px;
    }

    .panel-content::-webkit-scrollbar-thumb:hover {
      background: rgba(0, 255, 157, 0.5);
    }

    .message {
      background: rgba(255, 255, 255, 0.08);
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 15px;
      line-height: 1.6;
      font-size: 1.05em;
      animation: slideIn 0.3s ease;
      word-wrap: break-word;
      position: relative;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .message-text {
      flex: 1;
      user-select: text;
      cursor: text;
    }

    .copy-btn {
      background: rgba(0, 255, 157, 0.2);
      border: 1px solid rgba(0, 255, 157, 0.4);
      border-radius: 6px;
      padding: 6px 10px;
      color: #00ff9d;
      cursor: pointer;
      font-size: 0.9em;
      transition: all 0.2s ease;
      flex-shrink: 0;
      min-width: 35px;
      text-align: center;
    }

    .copy-btn:hover {
      background: rgba(0, 255, 157, 0.3);
      border-color: #00ff9d;
      transform: scale(1.05);
    }

    .copy-btn:active {
      transform: scale(0.95);
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .fr-panel .message {
      border-left: 4px solid #00a2ff;
    }

    .zh-panel .message {
      border-left: 4px solid #ff6b6b;
    }

    /* Volume Indicator */
    .volume-indicator {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 200px;
      height: 8px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
      overflow: hidden;
    }

    .volume-bar {
      height: 100%;
      background: linear-gradient(90deg, #00ff9d, #00a2ff);
      width: 0%;
      transition: width 0.1s ease;
      border-radius: 10px;
    }

    /* Permission Modal */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal-content {
      background: #1a1a2e;
      padding: 40px;
      border-radius: 20px;
      text-align: center;
      max-width: 400px;
    }

    .modal-content h2 {
      margin-bottom: 20px;
      color: #00ff9d;
    }

    .modal-content button {
      background: linear-gradient(90deg, #00ff9d, #00a2ff);
      color: #000;
      border: none;
      padding: 15px 40px;
      border-radius: 30px;
      font-size: 1.1em;
      font-weight: 600;
      cursor: pointer;
      margin-top: 20px;
      transition: transform 0.2s ease;
    }

    .modal-content button:hover {
      transform: scale(1.05);
    }

    .modal-content button:active {
      transform: scale(0.95);
    }

    .hidden {
      display: none;
    }

    /* Provider Badge */
    .provider-badge {
      background: rgba(0, 162, 255, 0.2);
      border: 1px solid rgba(0, 162, 255, 0.5);
      color: #00a2ff;
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 0.85em;
      transition: all 0.3s ease;
      white-space: nowrap;
    }

    .provider-badge:hover {
      background: rgba(0, 162, 255, 0.3);
    }

    /* Mobile Responsive */
    @media (max-width: 1024px) {
      /* Layout - Scroll horizontal sur mobile */
      .container {
        display: flex;
        flex-direction: row;
        gap: 0;
        padding: 0;
        padding-bottom: 100px; /* Espace pour controls mobiles */
        overflow-x: auto;
        overflow-y: hidden;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch; /* Smooth scroll sur iOS */
        scroll-behavior: smooth;
        scrollbar-width: none; /* Firefox */
        -ms-overflow-style: none; /* IE et Edge */
      }

      /* Masquer la scrollbar (WebKit) */
      .container::-webkit-scrollbar {
        display: none;
      }

      /* Chaque panel fait toute la largeur */
      .panel {
        min-width: 100vw;
        max-width: 100vw;
        flex-shrink: 0;
        scroll-snap-align: start;
        border-radius: 0;
        padding: 20px;
        padding-bottom: 140px; /* Espace pour contrôles mobiles + dots */
        margin: 0;
        height: 100%;
        max-height: 100%;
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }

      /* Panel content avec scroll interne */
      .panel-content {
        flex: 1;
        overflow-y: auto;
        min-height: 0;
        padding-bottom: 20px; /* Espace supplémentaire en bas */
      }

      /* Cacher contrôles centraux */
      .center-controls {
        display: none;
      }

      /* Montrer contrôles mobiles et indicateurs */
      .mobile-controls {
        display: flex;
      }

      .page-indicators {
        display: flex;
      }

      /* Header */
      header {
        padding: 10px 15px;
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
      }

      header > div:first-child {
        display: none;
      }

      .header-content {
        display: none;
      }

      .user-menu {
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      /* Montrer uniquement provider badge et bouton retour */
      .user-info,
      .admin-btn,
      .logout-btn {
        display: none !important;
      }

      .profile-btn {
        padding: 8px 16px;
        font-size: 0.9em;
      }

      /* Panels */
      .panel {
        padding: 15px;
        min-height: 250px;
      }

      .panel-header h2 {
        font-size: 1.4em;
      }

      .flag {
        font-size: 2em;
      }

      /* Messages - TEXTE PLUS GROS pour mobile */
      .message {
        font-size: 1.3em;
        padding: 18px;
        margin-bottom: 18px;
        line-height: 1.7;
      }

      /* Status Bar */
      .status-bar {
        font-size: 0.9em;
        padding: 8px 15px;
      }

      /* Volume Indicator - Plus haut pour ne pas cacher les controls */
      .volume-indicator {
        width: 150px;
        bottom: 90px;
      }

      /* Admin Panel */
      .admin-panel {
        padding: 10px;
      }

      .admin-content {
        padding: 20px 15px;
        max-height: 85vh;
      }

      .admin-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
        margin-bottom: 20px;
        padding-bottom: 15px;
      }

      .admin-header h2 {
        font-size: 1.5em;
      }

      .admin-section {
        margin-bottom: 20px;
      }

      .admin-section h3 {
        font-size: 1.1em;
      }

      .users-table {
        font-size: 0.9em;
      }

      .users-table th,
      .users-table td {
        padding: 8px;
      }

      .create-user-form {
        grid-template-columns: 1fr;
        gap: 8px;
      }

      /* Language Selection */
      .language-selection {
        padding: 10px;
      }

      .lang-box {
        padding: 30px 20px;
        margin-top: 0;
        margin-bottom: 0;
      }

      .lang-grid {
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
        gap: 12px;
      }

      .lang-flag .flag-emoji {
        font-size: 2.5em;
      }

      .lang-flag .flag-name {
        font-size: 0.85em;
      }

      /* Login */
      .login-box {
        padding: 35px 25px;
        max-width: 90%;
      }
    }

    /* Très petit mobile */
    @media (max-width: 480px) {
      .message {
        font-size: 1.2em;
        padding: 15px;
      }

      .panel-header h2 {
        font-size: 1.2em;
      }

      .control-buttons {
        bottom: 60px;
        gap: 8px;
      }

      .control-btn {
        min-width: 95px;
        padding: 10px 15px;
      }

      .push-to-talk-btn {
        width: 140px;
        height: 140px;
        bottom: 120px;
      }

      /* Admin Panel pour très petits écrans */
      .admin-panel {
        padding: 5px;
      }

      .admin-content {
        padding: 15px 10px;
        border-radius: 15px;
      }

      .admin-header h2 {
        font-size: 1.3em;
      }

      .admin-section h3 {
        font-size: 1em;
      }

      .users-table {
        font-size: 0.8em;
      }

      .users-table th,
      .users-table td {
        padding: 6px;
      }

      .close-admin-btn {
        padding: 8px 15px;
        font-size: 0.9em;
      }

      /* Modal responsive */
      .modal-content {
        padding: 25px 20px;
        max-width: 90%;
      }

      .modal-content h2 {
        font-size: 1.3em;
        margin-bottom: 15px;
      }

      .modal-content button {
        padding: 12px 30px;
        font-size: 1em;
      }
    }

    /* Desktop - Centre le contenu verticalement */
    @media (min-width: 769px) {
      .language-selection {
        align-items: center;
      }
    }

    /* Animation pour l'indicateur "en train d'écrire..." */
    .typing-dots::after {
      content: '';
      animation: typingDots 1.4s infinite;
    }

    @keyframes typingDots {
      0%, 20% {
        content: '';
      }
      40% {
        content: '.';
      }
      60% {
        content: '..';
      }
      80%, 100% {
        content: '...';
      }
    }

    /* Visually hidden but accessible to screen readers */
    .visually-hidden {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border-width: 0;
    }
  </style>

  <!-- Stripe.js -->
  <script src="https://js.stripe.com/v3/"></script>
</head>
<body>
  <!-- Login Screen -->
  <div id="loginContainer" class="login-container">
    <div class="login-box" style="max-width: 450px;">
      <h2 style="font-size: 2.5em; margin-bottom: 10px;">🌍 RealTranslate</h2>
      <p style="color: #888; margin-bottom: 30px;">Traduction instantanée et communication multilingue</p>

      <div id="loginError" class="error-message hidden"></div>

      <!-- OAuth Login Buttons -->
      <div style="display: flex; flex-direction: column; gap: 12px; margin-bottom: 25px;">
        <button onclick="loginWithGoogle()" style="display: flex; align-items: center; justify-content: center; gap: 12px; width: 100%; padding: 14px; background: #fff; color: #000; border: 2px solid #e0e0e0; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1em; transition: all 0.2s;" onmouseover="this.style.background='#f5f5f5'" onmouseout="this.style.background='#fff'">
          <svg width="20" height="20" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>
          Continuer avec Google
        </button>

        <button onclick="loginWithApple()" style="display: flex; align-items: center; justify-content: center; gap: 12px; width: 100%; padding: 14px; background: #000; color: #fff; border: 2px solid #000; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1em; transition: all 0.2s;" onmouseover="this.style.background='#1a1a1a'" onmouseout="this.style.background='#000'">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="white"><path d="M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"/></svg>
          Continuer avec Apple
        </button>

        <button onclick="loginWithWeChat()" style="display: flex; align-items: center; justify-content: center; gap: 12px; width: 100%; padding: 14px; background: #09b83e; color: #fff; border: 2px solid #09b83e; border-radius: 12px; cursor: pointer; font-weight: 600; font-size: 1em; transition: all 0.2s;" onmouseover="this.style.background='#08a838'" onmouseout="this.style.background='#09b83e'">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="white"><path d="M8.691 2.188C3.891 2.188 0 5.476 0 9.53c0 2.212 1.17 4.203 3.002 5.55a.59.59 0 0 1 .213.665l-.39 1.48c-.019.07-.048.141-.048.213 0 .163.13.295.29.295a.326.326 0 0 0 .167-.054l1.903-1.114a.864.864 0 0 1 .717-.098 10.16 10.16 0 0 0 2.837.403c.276 0 .543-.027.811-.05-.857-2.578.157-4.972 2.932-6.446C10.471 5.23 9.62 2.188 8.691 2.188zm5.785 8.926c-.653 0-1.217-.54-1.217-1.17 0-.653.564-1.194 1.217-1.194.653 0 1.168.54 1.168 1.194 0 .63-.515 1.17-1.168 1.17zm4.956 0c-.652 0-1.216-.54-1.216-1.17 0-.653.564-1.194 1.216-1.194.654 0 1.168.54 1.168 1.194 0 .63-.514 1.17-1.168 1.17z"/></svg>
          Continuer avec WeChat
        </button>
      </div>

      <!-- Divider -->
      <div style="display: flex; align-items: center; gap: 15px; margin: 25px 0;">
        <div style="flex: 1; height: 1px; background: rgba(255,255,255,0.2);"></div>
        <span style="color: #888; font-size: 0.9em;">ou</span>
        <div style="flex: 1; height: 1px; background: rgba(255,255,255,0.2);"></div>
      </div>

      <!-- Email/Password Login -->
      <form id="loginForm" onsubmit="return false;">
        <div class="input-group">
          <label for="email">Email</label>
          <input type="email" id="email" placeholder="votre@email.com" autocomplete="email">
        </div>

        <div class="input-group">
          <label for="password">Mot de passe</label>
          <input type="password" id="password" placeholder="••••••••" autocomplete="current-password">
        </div>

        <button type="submit" class="login-btn" id="loginBtn" style="width: 100%; margin-top: 10px;">Se connecter</button>
      </form>

      <div style="text-align: center; margin-top: 20px;">
        <button onclick="switchLoginMode('token')" style="background: none; border: none; color: #00ff9d; cursor: pointer; text-decoration: underline; font-size: 0.9em;">
          🎫 Se connecter avec un jeton d'accès
        </button>
      </div>

      <div style="display: flex; justify-content: center; align-items: center; gap: 15px; margin-top: 25px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
        <button onclick="showRegisterForm()" style="background: none; border: none; color: #fff; cursor: pointer; font-size: 0.95em; padding: 8px 16px; border-radius: 8px; transition: all 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.1)'" onmouseout="this.style.background='none'">
          ✨ Créer un compte
        </button>
        <span style="color: #444;">•</span>
        <button onclick="showPricing()" style="background: none; border: none; color: #fff; cursor: pointer; font-size: 0.95em; padding: 8px 16px; border-radius: 8px; transition: all 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.1)'" onmouseout="this.style.background='none'">
          💳 Voir les tarifs
        </button>
      </div>
    </div>
  </div>

  <!-- Register Screen -->
  <div id="registerContainer" class="login-container hidden">
    <div class="login-box" style="max-width: 450px;">
      <h2 style="font-size: 2.2em; margin-bottom: 10px;">✨ Créer un compte</h2>
      <p style="color: #888; margin-bottom: 30px;">Rejoignez RealTranslate et commencez à traduire</p>

      <div id="registerError" class="error-message hidden"></div>
      <div id="registerSuccess" class="success-message hidden"></div>

      <form id="registerForm" onsubmit="return false;">
        <div class="input-group">
          <label for="registerName">Nom d'affichage</label>
          <input type="text" id="registerName" placeholder="Votre nom" autocomplete="name" required>
        </div>

        <div class="input-group">
          <label for="registerEmail">Email</label>
          <input type="email" id="registerEmail" placeholder="votre@email.com" autocomplete="email" required>
        </div>

        <div class="input-group">
          <label for="registerPassword">Mot de passe</label>
          <input type="password" id="registerPassword" placeholder="••••••••" autocomplete="new-password" minlength="6" required>
        </div>

        <div class="input-group">
          <label for="registerPasswordConfirm">Confirmer le mot de passe</label>
          <input type="password" id="registerPasswordConfirm" placeholder="••••••••" autocomplete="new-password" minlength="6" required>
        </div>

        <button type="submit" class="login-btn" id="registerBtn" style="width: 100%; margin-top: 10px;">S'inscrire</button>
      </form>

      <div style="text-align: center; margin-top: 20px;">
        <button onclick="backToLogin()" style="background: none; border: none; color: #00ff9d; cursor: pointer; text-decoration: underline; font-size: 0.9em;">
          ← Retour à la connexion
        </button>
      </div>

      <div style="text-align: center; margin-top: 15px;">
        <button onclick="showPricing()" style="background: none; border: none; color: #fff; cursor: pointer; font-size: 0.9em; padding: 8px 16px; border-radius: 8px; transition: all 0.2s;" onmouseover="this.style.background='rgba(255,255,255,0.1)'" onmouseout="this.style.background='none'">
          💳 Voir les tarifs
        </button>
      </div>
    </div>
  </div>

  <!-- Pricing Screen -->
  <div id="pricingContainer" class="login-container hidden">
    <div class="login-box" style="max-width: 900px;">
      <h2 style="font-size: 2.2em; margin-bottom: 10px;">💳 Nos Tarifs</h2>
      <p style="color: #888; margin-bottom: 40px;">Choisissez l'abonnement qui vous convient</p>

      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
        <!-- Plan FREE -->
        <div style="background: rgba(255,255,255,0.05); border: 2px solid rgba(255,255,255,0.1); border-radius: 16px; padding: 30px; text-align: center;">
          <h3 style="font-size: 1.5em; margin-bottom: 10px;">🆓 Gratuit</h3>
          <div style="font-size: 2.5em; font-weight: bold; margin: 20px 0;">0€</div>
          <div style="color: #888; margin-bottom: 20px;">par mois</div>
          <ul style="text-align: left; list-style: none; padding: 0; margin: 20px 0;">
            <li style="padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">✅ 50 transcriptions/mois</li>
            <li style="padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">✅ 250 traductions/mois</li>
            <li style="padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">✅ 50 synthèses vocales/mois</li>
            <li style="padding: 8px 0;">✅ Communication de base</li>
          </ul>
        </div>

        <!-- Plan PREMIUM -->
        <div style="background: linear-gradient(135deg, rgba(0,255,157,0.2), rgba(0,200,255,0.2)); border: 2px solid #00ff9d; border-radius: 16px; padding: 30px; text-align: center; position: relative;">
          <div style="position: absolute; top: -12px; left: 50%; transform: translateX(-50%); background: #00ff9d; color: #000; padding: 4px 12px; border-radius: 20px; font-weight: bold; font-size: 0.8em;">POPULAIRE</div>
          <h3 style="font-size: 1.5em; margin-bottom: 10px;">⭐ Premium</h3>
          <div style="font-size: 2.5em; font-weight: bold; margin: 20px 0;">9.99€</div>
          <div style="color: #888; margin-bottom: 20px;">par mois</div>
          <ul style="text-align: left; list-style: none; padding: 0; margin: 20px 0;">
            <li style="padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">✅ 500 transcriptions/mois</li>
            <li style="padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">✅ 2500 traductions/mois</li>
            <li style="padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">✅ 500 synthèses vocales/mois</li>
            <li style="padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">✅ Groupes illimités</li>
            <li style="padding: 8px 0;">✅ Support prioritaire</li>
          </ul>
        </div>

        <!-- Plan ENTERPRISE -->
        <div style="background: rgba(255,255,255,0.05); border: 2px solid rgba(255,255,255,0.1); border-radius: 16px; padding: 30px; text-align: center;">
          <h3 style="font-size: 1.5em; margin-bottom: 10px;">🏢 Entreprise</h3>
          <div style="font-size: 2.5em; font-weight: bold; margin: 20px 0;">49.99€</div>
          <div style="color: #888; margin-bottom: 20px;">par mois</div>
          <ul style="text-align: left; list-style: none; padding: 0; margin: 20px 0;">
            <li style="padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">✅ 5000 transcriptions/mois</li>
            <li style="padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">✅ 25000 traductions/mois</li>
            <li style="padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">✅ 5000 synthèses vocales/mois</li>
            <li style="padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">✅ Fonctionnalités avancées</li>
            <li style="padding: 8px 0;">✅ Support dédié 24/7</li>
          </ul>
        </div>
      </div>

      <div style="text-align: center; margin-top: 30px;">
        <button onclick="backFromPricing()" class="login-btn" style="max-width: 300px;">
          ← Retour
        </button>
      </div>
    </div>
  </div>

  <!-- Permission Modal -->
  <div id="permissionModal" class="modal hidden">
    <div class="modal-content">
      <h2>🎤 Autorisation Microphone</h2>
      <p>RealTranslate a besoin d'accéder à votre microphone pour la traduction en temps réel.</p>
      <button onclick="requestMicrophonePermission()">Activer le Microphone</button>
    </div>
  </div>

  <!-- Token Login Modal -->
  <div id="tokenLoginModal" class="modal hidden">
    <div class="modal-content" style="max-width: 450px;">
      <h2>🎫 Connexion par jeton</h2>
      <p style="color: #888; margin-bottom: 20px;">Entrez votre jeton d'accès fourni par l'administrateur</p>

      <div class="input-group">
        <label for="accessTokenInput">Jeton d'accès</label>
        <input type="text" id="accessTokenInput" placeholder="AT-xxxxxxxxxxxxxxxxxx" autocomplete="off" style="font-family: monospace;">
      </div>

      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button onclick="closeTokenModal()" style="flex: 1; padding: 12px; background: rgba(255,255,255,0.1); color: #fff; border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; cursor: pointer;">Annuler</button>
        <button onclick="loginWithToken()" style="flex: 1; padding: 12px; background: #00ff9d; color: #000; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">Se connecter</button>
      </div>
    </div>
  </div>

  <!-- Main App (hidden until logged in) -->
  <div id="mainApp" class="hidden">
    <!-- Language Selection Screen -->
    <div id="languageSelection" class="language-selection hidden">
      <div class="lang-box">
        <h2>🌍 RealTranslate</h2>
        <p>Choisissez vos langues de traduction</p>

        <div class="lang-step">
          <h3>📱 Votre langue</h3>
          <div class="lang-grid" id="lang1Grid">
            <div class="lang-flag" data-lang="fr" onclick="selectLang1('fr')">
              <div class="flag-emoji">🇫🇷</div>
              <div class="flag-name">Français</div>
            </div>
            <div class="lang-flag" data-lang="en" onclick="selectLang1('en')">
              <div class="flag-emoji">🇬🇧</div>
              <div class="flag-name">English</div>
            </div>
            <div class="lang-flag" data-lang="zh" onclick="selectLang1('zh')">
              <div class="flag-emoji">🇨🇳</div>
              <div class="flag-name">中文</div>
            </div>
            <div class="lang-flag" data-lang="de" onclick="selectLang1('de')">
              <div class="flag-emoji">🇩🇪</div>
              <div class="flag-name">Deutsch</div>
            </div>
            <div class="lang-flag" data-lang="es" onclick="selectLang1('es')">
              <div class="flag-emoji">🇪🇸</div>
              <div class="flag-name">Español</div>
            </div>
            <div class="lang-flag" data-lang="it" onclick="selectLang1('it')">
              <div class="flag-emoji">🇮🇹</div>
              <div class="flag-name">Italiano</div>
            </div>
            <div class="lang-flag" data-lang="pt" onclick="selectLang1('pt')">
              <div class="flag-emoji">🇵🇹</div>
              <div class="flag-name">Português</div>
            </div>
          </div>
        </div>

        <div class="lang-step" id="lang2Section" style="display: none;">
          <h3>🗣️ Langue à traduire</h3>
          <div class="lang-grid" id="lang2Grid">
            <!-- Langues disponibles seront ajoutées dynamiquement -->
          </div>
        </div>

        <!-- Pricing Button -->
        <div style="text-align: center; margin: 20px 0;">
          <button onclick="showPricingPage()" style="padding: 12px 30px; background: linear-gradient(135deg, #ffd43b, #ff9800); color: #000; border: none; border-radius: 10px; cursor: pointer; font-size: 1em; font-weight: bold; box-shadow: 0 4px 15px rgba(255, 212, 59, 0.3); transition: transform 0.2s;">
            💎 Voir les tarifs et fonctionnalités
          </button>
        </div>

        <button class="lang-continue-btn" id="langContinueBtn" onclick="showInterfaceChoice()" disabled>
          Continuer
        </button>
      </div>
    </div>

    <!-- Interface Choice Screen (Étape C) -->
    <div id="interfaceChoice" class="language-selection hidden">
      <div class="lang-box" style="max-width: 800px;">
        <h2>🎯 Choisissez votre mode</h2>
        <p style="color: #888; margin-bottom: 40px;">Sélectionnez l'interface qui correspond à vos besoins</p>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 25px; margin-bottom: 30px;">
          <!-- Mode Traduction Simple -->
          <div onclick="selectInterfaceMode('translation')" style="padding: 35px 30px; background: linear-gradient(135deg, rgba(0,255,157,0.1), rgba(0,200,120,0.1)); border: 3px solid rgba(0,255,157,0.3); border-radius: 20px; cursor: pointer; transition: all 0.3s; position: relative;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 10px 30px rgba(0,255,157,0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
            <div style="text-align: center;">
              <div style="font-size: 4em; margin-bottom: 15px;">🎤</div>
              <h3 style="color: #00ff9d; font-size: 1.5em; margin-bottom: 15px;">Traduction Instantanée</h3>
              <p style="color: #ccc; line-height: 1.6; margin-bottom: 20px;">
                Interface de traduction vocale en temps réel. Parfait pour les conversations face à face, réunions, et échanges bilingues.
              </p>
              <ul style="text-align: left; color: #aaa; font-size: 0.95em; list-style: none; padding: 0;">
                <li style="margin-bottom: 8px;">✓ Traduction vocale instantanée</li>
                <li style="margin-bottom: 8px;">✓ Mode Push-to-Talk ou temps réel</li>
                <li style="margin-bottom: 8px;">✓ Interface simple et épurée</li>
                <li style="margin-bottom: 8px;">✓ Pas de compte requis</li>
              </ul>
            </div>
          </div>

          <!-- Mode Communication -->
          <div onclick="selectInterfaceMode('communication')" style="padding: 35px 30px; background: linear-gradient(135deg, rgba(100,180,255,0.1), rgba(50,120,255,0.1)); border: 3px solid rgba(100,180,255,0.3); border-radius: 20px; cursor: pointer; transition: all 0.3s; position: relative;" onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 10px 30px rgba(100,180,255,0.3)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
            <div style="text-align: center;">
              <div style="font-size: 4em; margin-bottom: 15px;">💬</div>
              <h3 style="color: #64b4ff; font-size: 1.5em; margin-bottom: 15px;">Communication Multilingue</h3>
              <p style="color: #ccc; line-height: 1.6; margin-bottom: 20px;">
                Plateforme complète de messagerie avec traduction automatique. Groupes, messages privés, et plus encore.
              </p>
              <ul style="text-align: left; color: #aaa; font-size: 0.95em; list-style: none; padding: 0;">
                <li style="margin-bottom: 8px;">✓ Groupes de discussion multilingues</li>
                <li style="margin-bottom: 8px;">✓ Messages privés (DM)</li>
                <li style="margin-bottom: 8px;">✓ Partage de fichiers et médias</li>
                <li style="margin-bottom: 8px;">✓ Mentions et notifications</li>
                <li style="margin-bottom: 8px;">✓ Statuts en ligne/hors ligne</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Boutons d'action -->
        <div style="display: flex; justify-content: center; gap: 15px; margin-bottom: 20px; flex-wrap: wrap;">
          <button onclick="showProfilePanel()" style="padding: 12px 24px; background: linear-gradient(135deg, rgba(0,255,157,0.2), rgba(0,200,120,0.2)); color: #00ff9d; border: 2px solid rgba(0,255,157,0.3); border-radius: 10px; cursor: pointer; font-size: 1em; font-weight: bold; transition: all 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
            ⚙️ Mon Profil
          </button>
          <button onclick="showPricingPage()" style="padding: 12px 24px; background: linear-gradient(135deg, rgba(255,212,59,0.2), rgba(255,152,0,0.2)); color: #ffd43b; border: 2px solid rgba(255,212,59,0.3); border-radius: 10px; cursor: pointer; font-size: 1em; font-weight: bold; transition: all 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
            💎 Voir les Tarifs
          </button>
          <button id="adminAccessBtn" onclick="showAdminPanel()" style="padding: 12px 24px; background: linear-gradient(135deg, rgba(255,59,59,0.2), rgba(200,0,0,0.2)); color: #ff6b6b; border: 2px solid rgba(255,59,59,0.3); border-radius: 10px; cursor: pointer; font-size: 1em; font-weight: bold; transition: all 0.2s; display: none;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
            🔧 Administration
          </button>
          <button onclick="logout()" style="padding: 12px 24px; background: linear-gradient(135deg, rgba(255,107,107,0.2), rgba(255,59,59,0.2)); color: #ff6b6b; border: 2px solid rgba(255,107,107,0.3); border-radius: 10px; cursor: pointer; font-size: 1em; font-weight: bold; transition: all 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
            ↗ Déconnexion
          </button>
        </div>

        <div style="text-align: center;">
          <button onclick="backToLanguageSelection()" style="padding: 12px 30px; background: rgba(255,255,255,0.1); color: #fff; border: 1px solid rgba(255,255,255,0.2); border-radius: 10px; cursor: pointer; font-size: 1em;">
            ← Retour
          </button>
        </div>
      </div>
    </div>

    <!-- Communication Interface (Home Page for Groups/DMs) -->
    <div id="communicationHome" class="language-selection hidden">
      <div class="communication-home-container">
        <div class="comm-header">
          <div class="comm-title-section">
            <h2 class="comm-title">💬 Communication Multilingue</h2>
            <p class="comm-subtitle">Groupes de discussion et messages privés traduits automatiquement</p>
          </div>
          <div class="comm-header-actions">
            <div class="comm-lang-badge">
              <div class="comm-lang-label">Langue</div>
              <div class="comm-lang-value" id="commLangDisplay">🇫🇷 Français</div>
            </div>
            <button onclick="showCommunicationSettings()" class="comm-btn comm-settings-btn">⚙️ <span class="comm-settings-text">Paramètres</span></button>
          </div>
        </div>

        <div class="comm-grid">
          <!-- Groupes Section -->
          <div class="comm-section">
            <div class="comm-section-header">
              <h3 class="comm-section-title">
                <span>👥</span> <span class="comm-section-title-text">Mes Groupes</span>
              </h3>
              <button onclick="showGroupsPanel()" class="comm-action-btn">
                <span class="btn-icon">➕</span> <span class="btn-text">Nouveau Groupe</span>
              </button>
            </div>

            <div id="commGroupsList" class="comm-list">
              <p class="comm-empty-message">Chargement de vos groupes...</p>
            </div>
          </div>

          <!-- Messages Privés Section -->
          <div class="comm-section">
            <div class="comm-section-header">
              <h3 class="comm-section-title">
                <span>💬</span> <span class="comm-section-title-text">Messages Privés</span>
              </h3>
              <button onclick="showDMsPanel()" class="comm-action-btn">
                <span class="btn-icon">✉️</span> <span class="btn-text">Nouveau Message</span>
              </button>
            </div>

            <div id="commDMsList" class="comm-list">
              <p class="comm-empty-message">Chargement de vos conversations...</p>
            </div>
          </div>

          <!-- Amis Section -->
          <div class="comm-section">
            <div class="comm-section-header">
              <h3 class="comm-section-title">
                <span>👥</span> <span class="comm-section-title-text">Mes Amis</span>
              </h3>
              <button onclick="showFriendsPanel()" class="comm-action-btn">
                <span class="btn-icon">➕</span> <span class="btn-text">Gérer Amis</span>
              </button>
            </div>

            <div id="commFriendsList" class="comm-list">
              <p class="comm-empty-message">Chargement de vos amis...</p>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="comm-quick-actions">
          <button onclick="showFriendsPanel()" class="comm-quick-btn comm-quick-btn-primary">
            <span>👥</span> <span class="comm-quick-text">Gérer mes amis</span>
          </button>
          <button onclick="browsePublicGroups(); showGroupsPanel();" class="comm-quick-btn comm-quick-btn-primary">
            <span>🌐</span> <span class="comm-quick-text">Découvrir les groupes publics</span>
          </button>
          <button onclick="resetInterfaceChoice()" class="comm-quick-btn comm-quick-btn-secondary">
            <span>←</span> <span class="comm-quick-text">Retour au menu</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Pricing Page -->
    <div id="pricingPage" class="language-selection hidden">
      <div class="lang-box" style="max-width: 1000px;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
          <h2>💎 Tarifs & Fonctionnalités</h2>
          <button onclick="hidePricingPage()" style="padding: 8px 20px; background: rgba(255,255,255,0.1); color: #fff; border: 1px solid rgba(255,255,255,0.3); border-radius: 8px; cursor: pointer;">
            ← Retour
          </button>
        </div>
        <p style="color: #ccc; text-align: center; margin-bottom: 30px;" id="pricingSubtitle">Choisissez le plan adapté à vos besoins</p>

        <!-- Pricing Cards Grid -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; margin-bottom: 40px;">
          <!-- FREE -->
          <div style="padding: 30px 25px; background: linear-gradient(135deg, rgba(136,136,136,0.1), rgba(100,100,100,0.1)); border-radius: 15px; border: 2px solid #888; position: relative; overflow: hidden;">
            <div style="text-align: center; margin-bottom: 25px;">
              <div style="font-size: 3.5em; margin-bottom: 10px;">🆓</div>
              <div style="font-weight: bold; color: #fff; font-size: 1.4em; margin-bottom: 5px;" data-i18n="pricing-free-title">GRATUIT</div>
              <div style="font-size: 2em; color: #888; font-weight: bold;">0€</div>
              <div style="color: #888; font-size: 0.9em;" data-i18n="pricing-per-month">/mois</div>
            </div>
            <div style="color: #ccc; font-size: 0.95em; line-height: 2;">
              <div style="margin-bottom: 12px; display: flex; align-items: center;">
                <span style="color: #00ff9d; margin-right: 10px;">✓</span>
                <span><strong>50</strong> <span data-i18n="pricing-transcriptions">transcriptions</span>/mois</span>
              </div>
              <div style="margin-bottom: 12px; display: flex; align-items: center;">
                <span style="color: #00ff9d; margin-right: 10px;">✓</span>
                <span><strong>250</strong> <span data-i18n="pricing-translations">traductions</span>/mois</span>
              </div>
              <div style="margin-bottom: 12px; display: flex; align-items: center;">
                <span style="color: #00ff9d; margin-right: 10px;">✓</span>
                <span><strong>50</strong> <span data-i18n="pricing-tts">synthèses vocales</span>/mois</span>
              </div>
              <div style="margin-bottom: 12px; display: flex; align-items: center;">
                <span style="color: #00ff9d; margin-right: 10px;">✓</span>
                <span data-i18n="pricing-7-languages">7 langues disponibles</span>
              </div>
            </div>
          </div>

          <!-- PREMIUM -->
          <div style="padding: 30px 25px; background: linear-gradient(135deg, rgba(255,212,59,0.15), rgba(255,152,0,0.15)); border-radius: 15px; border: 3px solid #ffd43b; position: relative; transform: scale(1.05); box-shadow: 0 8px 30px rgba(255,212,59,0.3);">
            <div style="position: absolute; top: -12px; right: 20px; background: #ffd43b; color: #000; padding: 5px 15px; border-radius: 15px; font-size: 0.8em; font-weight: bold;" data-i18n="pricing-popular">POPULAIRE</div>
            <div style="text-align: center; margin-bottom: 25px;">
              <div style="font-size: 3.5em; margin-bottom: 10px;">⭐</div>
              <div style="font-weight: bold; color: #fff; font-size: 1.4em; margin-bottom: 5px;" data-i18n="pricing-premium-title">PREMIUM</div>
              <div style="font-size: 2em; color: #ffd43b; font-weight: bold;">9.99€</div>
              <div style="color: #ffd43b; font-size: 0.9em;" data-i18n="pricing-per-month">/mois</div>
            </div>
            <div style="color: #ccc; font-size: 0.95em; line-height: 2;">
              <div style="margin-bottom: 12px; display: flex; align-items: center;">
                <span style="color: #ffd43b; margin-right: 10px;">✓</span>
                <span><strong>500</strong> <span data-i18n="pricing-transcriptions">transcriptions</span>/mois</span>
              </div>
              <div style="margin-bottom: 12px; display: flex; align-items: center;">
                <span style="color: #ffd43b; margin-right: 10px;">✓</span>
                <span><strong>2,500</strong> <span data-i18n="pricing-translations">traductions</span>/mois</span>
              </div>
              <div style="margin-bottom: 12px; display: flex; align-items: center;">
                <span style="color: #ffd43b; margin-right: 10px;">✓</span>
                <span><strong>500</strong> <span data-i18n="pricing-tts">synthèses vocales</span>/mois</span>
              </div>
              <div style="margin-bottom: 12px; display: flex; align-items: center;">
                <span style="color: #ffd43b; margin-right: 10px;">✓</span>
                <span data-i18n="pricing-7-languages">7 langues disponibles</span>
              </div>
              <div style="margin-bottom: 12px; display: flex; align-items: center;">
                <span style="color: #ffd43b; margin-right: 10px;">✓</span>
                <span data-i18n="pricing-priority-support">Support prioritaire</span>
              </div>
            </div>
            <button onclick="subscribePlan('premium')" style="width: 100%; margin-top: 20px; padding: 15px; background: #ffd43b; color: #000; border: none; border-radius: 10px; font-weight: bold; font-size: 1.1em; cursor: pointer;" data-i18n="pricing-subscribe">
              S'abonner
            </button>
          </div>

          <!-- ENTERPRISE -->
          <div style="padding: 30px 25px; background: linear-gradient(135deg, rgba(0,255,157,0.15), rgba(0,200,120,0.15)); border-radius: 15px; border: 2px solid #00ff9d; position: relative;">
            <div style="text-align: center; margin-bottom: 25px;">
              <div style="font-size: 3.5em; margin-bottom: 10px;">💎</div>
              <div style="font-weight: bold; color: #fff; font-size: 1.4em; margin-bottom: 5px;" data-i18n="pricing-enterprise-title">ENTERPRISE</div>
              <div style="font-size: 2em; color: #00ff9d; font-weight: bold;">49.99€</div>
              <div style="color: #00ff9d; font-size: 0.9em;" data-i18n="pricing-per-month">/mois</div>
            </div>
            <div style="color: #ccc; font-size: 0.95em; line-height: 2;">
              <div style="margin-bottom: 12px; display: flex; align-items: center;">
                <span style="color: #00ff9d; margin-right: 10px;">✓</span>
                <span><strong>5,000</strong> <span data-i18n="pricing-transcriptions">transcriptions</span>/mois</span>
              </div>
              <div style="margin-bottom: 12px; display: flex; align-items: center;">
                <span style="color: #00ff9d; margin-right: 10px;">✓</span>
                <span><strong>25,000</strong> <span data-i18n="pricing-translations">traductions</span>/mois</span>
              </div>
              <div style="margin-bottom: 12px; display: flex; align-items: center;">
                <span style="color: #00ff9d; margin-right: 10px;">✓</span>
                <span><strong>5,000</strong> <span data-i18n="pricing-tts">synthèses vocales</span>/mois</span>
              </div>
              <div style="margin-bottom: 12px; display: flex; align-items: center;">
                <span style="color: #00ff9d; margin-right: 10px;">✓</span>
                <span data-i18n="pricing-7-languages">7 langues disponibles</span>
              </div>
              <div style="margin-bottom: 12px; display: flex; align-items: center;">
                <span style="color: #00ff9d; margin-right: 10px;">✓</span>
                <span data-i18n="pricing-dedicated-support">Support dédié 24/7</span>
              </div>
              <div style="margin-bottom: 12px; display: flex; align-items: center;">
                <span style="color: #00ff9d; margin-right: 10px;">✓</span>
                <span data-i18n="pricing-api-access">Accès API</span>
              </div>
            </div>
            <button onclick="subscribePlan('enterprise')" style="width: 100%; margin-top: 20px; padding: 15px; background: #00ff9d; color: #000; border: none; border-radius: 10px; font-weight: bold; font-size: 1.1em; cursor: pointer;" data-i18n="pricing-subscribe">
              S'abonner
            </button>
          </div>
        </div>

        <!-- Payment Methods -->
        <div style="background: rgba(255,255,255,0.05); border-radius: 15px; padding: 25px; margin-bottom: 30px;">
          <h3 style="text-align: center; color: #fff; margin-bottom: 20px;" data-i18n="pricing-payment-methods">Modes de paiement acceptés</h3>
          <div style="display: flex; justify-content: center; align-items: center; gap: 40px; flex-wrap: wrap;">
            <div style="text-align: center;">
              <div style="font-size: 3em; margin-bottom: 8px;">💳</div>
              <div style="color: #ccc; font-weight: bold;">Carte Bancaire</div>
              <div style="color: #888; font-size: 0.85em;">Stripe Checkout</div>
            </div>
            <div style="text-align: center;">
              <div style="font-size: 3em; margin-bottom: 8px;">🔵</div>
              <div style="color: #ccc; font-weight: bold;">PayPal</div>
              <div style="color: #888; font-size: 0.85em;" data-i18n="pricing-europe-region">À venir</div>
            </div>
            <div style="text-align: center;">
              <div style="font-size: 3em; margin-bottom: 8px;">💚</div>
              <div style="color: #ccc; font-weight: bold;">WeChat Pay</div>
              <div style="color: #888; font-size: 0.85em;" data-i18n="pricing-asia-region">À venir</div>
            </div>
          </div>
        </div>

        <!-- FAQ Section -->
        <div style="background: rgba(255,255,255,0.03); border-radius: 15px; padding: 25px;">
          <h3 style="text-align: center; color: #fff; margin-bottom: 20px;" data-i18n="pricing-faq">Questions fréquentes</h3>
          <div style="color: #ccc; line-height: 1.8;">
            <div style="margin-bottom: 15px;">
              <strong style="color: #00ff9d;" data-i18n="pricing-faq-q1">🔹 Comment fonctionne l'abonnement ?</strong>
              <p style="margin: 5px 0 0 20px;" data-i18n="pricing-faq-a1">Votre abonnement est actif immédiatement après paiement et se renouvelle automatiquement chaque mois.</p>
            </div>
            <div style="margin-bottom: 15px;">
              <strong style="color: #00ff9d;" data-i18n="pricing-faq-q2">🔹 Puis-je annuler à tout moment ?</strong>
              <p style="margin: 5px 0 0 20px;" data-i18n="pricing-faq-a2">Oui, vous pouvez annuler votre abonnement à tout moment. Vous conserverez l'accès jusqu'à la fin de la période payée.</p>
            </div>
            <div style="margin-bottom: 15px;">
              <strong style="color: #00ff9d;" data-i18n="pricing-faq-q3">🔹 Les quotas se reportent-ils ?</strong>
              <p style="margin: 5px 0 0 20px;" data-i18n="pricing-faq-a3">Non, les quotas sont journaliers et se réinitialisent à minuit (heure UTC).</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Header -->
    <header>
      <div style="display: flex; align-items: center; gap: 10px;">
        <button id="themeToggleBtn" onclick="toggleTheme()" style="background: var(--button-bg); border: 1px solid var(--button-border); color: var(--text-primary); padding: 8px 12px; border-radius: 8px; cursor: pointer; font-size: 1.2em; transition: all 0.3s ease;" title="Changer de thème">
          🌙
        </button>
        <div style="position: relative;">
          <button id="colorThemeBtn" onclick="toggleColorThemeMenu()" style="background: var(--button-bg); border: 1px solid var(--button-border); color: var(--text-primary); padding: 8px 12px; border-radius: 8px; cursor: pointer; font-size: 1.2em; transition: all 0.3s ease;" title="Choisir la couleur du thème">
            🎨
          </button>
          <div id="colorThemeMenu" style="display: none; position: absolute; top: 45px; left: 0; background: var(--panel-bg); border: 1px solid var(--panel-border); border-radius: 8px; padding: 8px; backdrop-filter: blur(10px); z-index: 1000; min-width: 150px;">
            <div onclick="changeColorTheme('green')" style="padding: 8px 12px; cursor: pointer; border-radius: 6px; margin-bottom: 4px; display: flex; align-items: center; gap: 8px; transition: background 0.2s;" onmouseover="this.style.background='var(--input-bg)'" onmouseout="this.style.background='transparent'">
              <span style="width: 20px; height: 20px; border-radius: 50%; background: linear-gradient(90deg, #00ff9d, #00a2ff);"></span>
              <span style="color: var(--text-primary);">Vert/Cyan</span>
            </div>
            <div onclick="changeColorTheme('blue')" style="padding: 8px 12px; cursor: pointer; border-radius: 6px; margin-bottom: 4px; display: flex; align-items: center; gap: 8px; transition: background 0.2s;" onmouseover="this.style.background='var(--input-bg)'" onmouseout="this.style.background='transparent'">
              <span style="width: 20px; height: 20px; border-radius: 50%; background: linear-gradient(90deg, #4da6ff, #0066ff);"></span>
              <span style="color: var(--text-primary);">Bleu</span>
            </div>
            <div onclick="changeColorTheme('purple')" style="padding: 8px 12px; cursor: pointer; border-radius: 6px; margin-bottom: 4px; display: flex; align-items: center; gap: 8px; transition: background 0.2s;" onmouseover="this.style.background='var(--input-bg)'" onmouseout="this.style.background='transparent'">
              <span style="width: 20px; height: 20px; border-radius: 50%; background: linear-gradient(90deg, #a855f7, #6366f1);"></span>
              <span style="color: var(--text-primary);">Violet</span>
            </div>
            <div onclick="changeColorTheme('pink')" style="padding: 8px 12px; cursor: pointer; border-radius: 6px; margin-bottom: 4px; display: flex; align-items: center; gap: 8px; transition: background 0.2s;" onmouseover="this.style.background='var(--input-bg)'" onmouseout="this.style.background='transparent'">
              <span style="width: 20px; height: 20px; border-radius: 50%; background: linear-gradient(90deg, #ff6b9d, #ff1f7e);"></span>
              <span style="color: var(--text-primary);">Rose</span>
            </div>
            <div onclick="changeColorTheme('orange')" style="padding: 8px 12px; cursor: pointer; border-radius: 6px; display: flex; align-items: center; gap: 8px; transition: background 0.2s;" onmouseover="this.style.background='var(--input-bg)'" onmouseout="this.style.background='transparent'">
              <span style="width: 20px; height: 20px; border-radius: 50%; background: linear-gradient(90deg, #ff9f43, #ff6348);"></span>
              <span style="color: var(--text-primary);">Orange</span>
            </div>
          </div>
        </div>
      </div>
      <div class="header-content">
        <h1>RealTranslate</h1>
        <div class="subtitle" id="appSubtitle">Traduction en Temps Réel</div>
      </div>
      <div class="user-menu">
        <div id="providerBadge" class="provider-badge hidden">
          <span id="providerName">-</span>
        </div>
        <span class="user-info" id="userInfo"></span>
        <button class="admin-btn hidden" id="adminBtn" onclick="showAdminPanel()">👤 Admin</button>
        <button class="profile-btn" id="changeModeBtn" onclick="resetInterfaceChoice()" title="Revenir au menu principal">← Retour</button>
        <button class="logout-btn" onclick="logout()">↗ Déconnexion</button>
      </div>
    </header>

  <!-- Status Bar -->
  <div id="statusBar" class="status-bar idle">
    <div class="status-indicator"></div>
    <span id="statusText">Initialisation...</span>
  </div>

  <!-- VU-Mètre Micro - Ligne horizontale simple -->
  <div id="vuMeter" class="vu-meter hidden"></div>

  <!-- Main Container -->
  <div class="container">
    <!-- Left Panel -->
    <div class="panel lang1-panel">
      <div class="panel-header">
        <span class="flag" id="flag1">🌐</span>
        <h2 id="langName1">Langue 1</h2>
      </div>
      <div id="frContent" class="panel-content"></div>
    </div>

    <!-- Center Controls (Desktop only) -->
    <div class="center-controls">
      <!-- Micro Button -->
      <button class="center-control-btn active" id="micBtn" onclick="toggleMicrophone()">
        <span id="micIcon" class="icon">🎤</span>
        <span id="micText" class="label">Micro ON</span>
      </button>

      <!-- Mode Switch -->
      <div class="mode-switch-container">
        <div class="mode-switch-label">Mode</div>
        <div class="mode-switch" id="modeSwitch" onclick="toggleMode()">
          <span class="mode-switch-text right">Temps Réel</span>
          <span class="mode-switch-text left">PTT</span>
        </div>
      </div>

      <!-- Push to Talk Button -->
      <button class="ptt-btn hidden" id="pushToTalkBtn">
        <span class="icon">🎤</span>
        <span class="label">Maintenir<br>pour parler</span>
      </button>

      <!-- Audio Button -->
      <button class="center-control-btn active" id="ttsBtn" onclick="toggleTTS()">
        <span id="ttsIcon" class="icon">🔊</span>
        <span id="ttsText" class="label">Audio ON</span>
      </button>
    </div>

    <!-- Right Panel -->
    <div class="panel lang2-panel">
      <div class="panel-header">
        <span class="flag" id="flag2">🌐</span>
        <h2 id="langName2">Langue 2</h2>
      </div>
      <div id="zhContent" class="panel-content"></div>
    </div>
  </div>

  <!-- Page Indicators (Mobile only) -->
  <div class="page-indicators">
    <span class="page-dot active" data-page="0"></span>
    <span class="page-dot" data-page="1"></span>
  </div>

  <!-- Mobile Controls (Hidden on desktop) -->
  <div class="mobile-controls">
    <button class="mobile-control-btn active" id="micBtnMobile" onclick="toggleMicrophone()">
      <span id="micIconMobile">🎤</span>
    </button>

    <div class="mode-switch-container-mobile">
      <div class="mode-switch-mobile" id="modeSwitchMobile" onclick="toggleMode()">
        <span class="mode-text">PTT</span>
        <span class="mode-text">Temps Réel</span>
      </div>
    </div>

    <button class="mobile-ptt-btn hidden" id="pushToTalkBtnMobile">
      <span>🎤</span> PTT
    </button>

    <button class="mobile-control-btn active" id="ttsBtnMobile" onclick="toggleTTS()">
      <span id="ttsIconMobile">🔊</span>
    </button>
  </div>

  <!-- Admin Panel -->
  <div id="adminPanel" class="admin-panel hidden">
    <div class="admin-content">
      <div class="admin-header">
        <h2>👤 Panneau Administrateur</h2>
        <button class="close-admin-btn" onclick="closeAdminPanel()">✕ Fermer</button>
      </div>

      <!-- Admin Tabs -->
      <div style="display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid rgba(255,255,255,0.1); padding-bottom: 10px;">
        <button id="tabUsers" onclick="switchAdminTab('users')" style="flex: 1; padding: 12px 20px; background: #00ff9d; color: #000; border: none; border-radius: 8px 8px 0 0; cursor: pointer; font-weight: bold; font-size: 1em;">
          👥 Utilisateurs
        </button>
        <button id="tabSubscriptions" onclick="switchAdminTab('subscriptions')" style="flex: 1; padding: 12px 20px; background: rgba(255,255,255,0.1); color: #fff; border: none; border-radius: 8px 8px 0 0; cursor: pointer; font-size: 1em;">
          💳 Abonnements & Jetons
        </button>
        <button id="tabGroups" onclick="switchAdminTab('groups')" style="flex: 1; padding: 12px 20px; background: rgba(255,255,255,0.1); color: #fff; border: none; border-radius: 8px 8px 0 0; cursor: pointer; font-size: 1em;">
          💬 Groupes
        </button>
        <button id="tabLogs" onclick="switchAdminTab('logs')" style="flex: 1; padding: 12px 20px; background: rgba(255,255,255,0.1); color: #fff; border: none; border-radius: 8px 8px 0 0; cursor: pointer; font-size: 1em;">
          📋 Logs
        </button>
      </div>

      <!-- TAB 1: UTILISATEURS -->
      <div id="adminTabUsers" style="display: block;">
        <!-- Create User Section -->
      <div class="admin-section">
        <h3>➕ Créer un utilisateur</h3>
        <div id="adminMessage" class="hidden" style="margin-bottom: 15px;"></div>
        <form class="create-user-form" onsubmit="return false;">
          <div class="input-group" style="margin-bottom: 0;">
            <label for="newUserEmail" class="visually-hidden">Email</label>
            <input type="email" id="newUserEmail" placeholder="Email" autocomplete="email" required>
          </div>
          <div class="input-group" style="margin-bottom: 0;">
            <label for="newUserPassword" class="visually-hidden">Mot de passe</label>
            <input type="password" id="newUserPassword" placeholder="Mot de passe" autocomplete="new-password" required>
          </div>
          <div class="input-group" style="margin-bottom: 0;">
            <select id="newUserRole">
              <option value="user">Utilisateur</option>
              <option value="admin">Admin</option>
              <option value="guest">Invité</option>
            </select>
          </div>
          <button class="create-user-btn" id="createUserBtn" onclick="createUser()">Créer</button>
        </form>
      </div>

        <!-- Users List Section -->
        <div class="admin-section">
          <h3>👥 Liste des Utilisateurs</h3>
          <div id="usersTableContainer">
            <div style="text-align: center; padding: 20px; color: #888;">
              <div class="loading-spinner" style="margin: 0 auto 10px;"></div>
              <p>Chargement...</p>
            </div>
          </div>
        </div>
      </div>

      <!-- TAB 2: ABONNEMENTS & JETONS -->
      <div id="adminTabSubscriptions" style="display: none;">
        <!-- Access Token Management Section -->
      <div class="admin-section">
        <h3>🎫 Gestion des Jetons d'Accès</h3>
        <div style="margin-bottom: 15px;">
          <p style="color: #888; font-size: 0.9em; margin-bottom: 10px;">Générer un jeton d'accès à usage unique</p>
          <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 10px;">
            <select id="tokenTier" style="padding: 10px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #fff;">
              <option value="free">🆓 Gratuit</option>
              <option value="premium">⭐ Premium</option>
              <option value="enterprise">💎 Enterprise</option>
              <option value="admin">👑 Admin</option>
            </select>
            <div style="flex: 1; min-width: 150px;">
              <label for="tokenMaxUses" style="display: block; color: #888; font-size: 0.85em; margin-bottom: 3px;">Max utilisations</label>
              <input type="number" id="tokenMaxUses" value="1" min="1" autocomplete="off" style="width: 100%; padding: 10px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #fff;">
            </div>
            <div style="flex: 1; min-width: 150px;">
              <label for="tokenExpiryDays" style="display: block; color: #888; font-size: 0.85em; margin-bottom: 3px;">Validité (jours)</label>
              <input type="number" id="tokenExpiryDays" value="30" min="1" autocomplete="off" style="width: 100%; padding: 10px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #fff;">
            </div>
            <div style="flex: 1; min-width: 200px;">
              <label for="tokenDescription" class="visually-hidden">Description</label>
              <input type="text" id="tokenDescription" placeholder="Description (optionnelle)" autocomplete="off" style="width: 100%; padding: 10px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #fff;">
            </div>
            <button class="create-user-btn" onclick="generateAccessToken()" style="margin: 0; align-self: flex-end;">🎫 Générer</button>
          </div>
        </div>
        <div id="tokenResult" style="margin-bottom: 15px;"></div>

        <!-- Liste des jetons -->
        <div style="margin-top: 20px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
            <h4 style="margin: 0; color: #fff;">Jetons actifs</h4>
            <button class="create-user-btn" onclick="loadAccessTokens()" style="margin: 0; padding: 8px 15px; font-size: 0.9em;">🔄 Actualiser</button>
          </div>
          <div id="tokensListContainer" style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; max-height: 300px; overflow-y: auto;">
            <div style="text-align: center; padding: 20px; color: #888;">
              <p>Cliquez sur Actualiser pour afficher les jetons</p>
            </div>
          </div>
        </div>
      </div>

        <!-- Subscription Management Section -->
        <div class="admin-section">
          <h3>💳 Gestion des Abonnements</h3>
          <div style="margin-bottom: 15px;">
            <p style="color: #888; font-size: 0.9em; margin-bottom: 10px;">Mettre à jour l'abonnement d'un utilisateur</p>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
              <label for="subscriptionEmail" class="visually-hidden">Email de l'utilisateur</label>
              <input type="email" id="subscriptionEmail" placeholder="Email de l'utilisateur" autocomplete="email" style="flex: 1; min-width: 200px; padding: 10px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #fff;">
              <select id="subscriptionTier" style="padding: 10px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #fff;">
                <option value="free">🆓 Gratuit (5/25/5)</option>
                <option value="premium">⭐ Premium (20/100/20) - 9.99€</option>
                <option value="enterprise">💎 Enterprise (200/1000/200) - 49.99€</option>
                <option value="admin">👑 Admin (∞ Illimité)</option>
              </select>
              <button class="create-user-btn" onclick="updateUserSubscription()" style="margin: 0;">✅ Mettre à jour</button>
              <button class="create-user-btn" onclick="deleteUserSubscription()" style="margin: 0; background: #ff6b6b;">🗑️ Supprimer</button>
            </div>
          </div>
          <div id="subscriptionResult" style="margin-top: 10px;"></div>
        </div>
      </div>

      <!-- TAB 3: GROUPES -->
      <div id="adminTabGroups" style="display: none;">
        <!-- All Groups Section -->
        <div class="admin-section">
          <h3>💬 Tous les Groupes</h3>
          <div style="display: flex; gap: 10px; margin-bottom: 15px;">
            <button class="create-user-btn" onclick="loadAllGroupsAdmin()" style="margin: 0;">🔄 Actualiser</button>
            <div style="flex: 1; display: flex; gap: 10px; align-items: center;">
              <label style="color: #888; white-space: nowrap;">Filtrer:</label>
              <select id="groupFilterType" onchange="loadAllGroupsAdmin()" style="padding: 10px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #fff;">
                <option value="all">Tous les groupes</option>
                <option value="public">🌐 Publics uniquement</option>
                <option value="private">🔒 Privés uniquement</option>
              </select>
            </div>
          </div>
          <div id="adminGroupsContainer" style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; max-height: 500px; overflow-y: auto;">
            <div style="text-align: center; padding: 20px; color: #888;">
              <p>Cliquez sur Actualiser pour charger les groupes</p>
            </div>
          </div>
        </div>

        <!-- Group Statistics -->
        <div class="admin-section">
          <h3>📊 Statistiques</h3>
          <div id="groupStatsContainer" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
            <div style="background: rgba(0,255,157,0.1); border: 2px solid #00ff9d; border-radius: 10px; padding: 15px; text-align: center;">
              <div style="font-size: 2em; font-weight: bold; color: #00ff9d;" id="totalGroupsCount">-</div>
              <div style="color: #888; margin-top: 5px;">Total groupes</div>
            </div>
            <div style="background: rgba(100,180,255,0.1); border: 2px solid #64b4ff; border-radius: 10px; padding: 15px; text-align: center;">
              <div style="font-size: 2em; font-weight: bold; color: #64b4ff;" id="publicGroupsCount">-</div>
              <div style="color: #888; margin-top: 5px;">Groupes publics</div>
            </div>
            <div style="background: rgba(255,107,107,0.1); border: 2px solid #ff6b6b; border-radius: 10px; padding: 15px; text-align: center;">
              <div style="font-size: 2em; font-weight: bold; color: #ff6b6b;" id="privateGroupsCount">-</div>
              <div style="color: #888; margin-top: 5px;">Groupes privés</div>
            </div>
            <div style="background: rgba(255,212,59,0.1); border: 2px solid #ffd43b; border-radius: 10px; padding: 15px; text-align: center;">
              <div style="font-size: 2em; font-weight: bold; color: #ffd43b;" id="totalMembersCount">-</div>
              <div style="color: #888; margin-top: 5px;">Total membres</div>
            </div>
          </div>
        </div>
      </div>

      <!-- TAB 4: LOGS -->
      <div id="adminTabLogs" style="display: none;">
          <!-- Logs Viewer Section -->
        <div class="admin-section">
          <h3>📋 Visualisation des Logs</h3>
          <div style="margin-bottom: 15px;">
            <div style="display: flex; gap: 10px; align-items: flex-end; flex-wrap: wrap; margin-bottom: 10px;">
              <div style="flex: 1; min-width: 200px;">
                <label style="display: block; color: #888; font-size: 0.85em; margin-bottom: 3px;">Type de log</label>
                <select id="logType" style="width: 100%; padding: 10px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #fff;">
                  <option value="app">Application (app.log)</option>
                  <option value="error">Erreurs (error.log)</option>
                  <option value="access">Accès (access.log)</option>
                  <option value="auth">Authentification (auth.log)</option>
                  <option value="api">API (api.log)</option>
                </select>
              </div>
              <div style="flex: 1; min-width: 200px;">
                <label for="logDateFilter" style="display: block; color: #888; font-size: 0.85em; margin-bottom: 3px;">Filtrer par date/heure (optionnel)</label>
                <input type="datetime-local" id="logDateFilter" autocomplete="off" style="width: 100%; padding: 10px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #fff;">
              </div>
              <button class="create-user-btn" onclick="loadLogs()" style="margin: 0;">🔄 Actualiser</button>
              <button class="create-user-btn" onclick="exportLogs()" style="margin: 0; background: #ffd43b; color: #000;">📥 Exporter</button>
            </div>
          </div>
          <div id="logsContainer" style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; max-height: 400px; overflow-y: auto; font-family: 'Courier New', monospace; font-size: 0.85em; line-height: 1.6;">
            <div style="text-align: center; padding: 20px; color: #888;">
              <p>Sélectionnez un type de log et cliquez sur Actualiser</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Profile Panel -->
  <div id="profilePanel" class="admin-panel hidden">
    <div class="admin-content">
      <div class="admin-header">
        <h2>⚙️ Mon Profil</h2>
        <button class="close-admin-btn" onclick="closeProfilePanel()">✕ Fermer</button>
      </div>

      <!-- Profile Tabs -->
      <div style="display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid rgba(255,255,255,0.1); padding-bottom: 10px;">
        <button id="profileTabAccount" onclick="switchProfileTab('account')" style="flex: 1; padding: 12px 20px; background: #00ff9d; color: #000; border: none; border-radius: 8px 8px 0 0; cursor: pointer; font-weight: bold; font-size: 1em;">
          👤 Compte
        </button>
        <button id="profileTabPassword" onclick="switchProfileTab('password')" style="flex: 1; padding: 12px 20px; background: rgba(255,255,255,0.1); color: #fff; border: none; border-radius: 8px 8px 0 0; cursor: pointer; font-size: 1em;">
          🔐 Mot de passe
        </button>
        <button id="profileTabHistory" onclick="switchProfileTab('history')" style="flex: 1; padding: 12px 20px; background: rgba(255,255,255,0.1); color: #fff; border: none; border-radius: 8px 8px 0 0; cursor: pointer; font-size: 1em;">
          📜 Historique
        </button>
        <button id="profileTabDanger" onclick="switchProfileTab('danger')" style="flex: 1; padding: 12px 20px; background: rgba(255,255,255,0.1); color: #fff; border: none; border-radius: 8px 8px 0 0; cursor: pointer; font-size: 1em;">
          ⚠️ Zone dangereuse
        </button>
      </div>

      <!-- TAB 1: COMPTE -->
      <div id="profileTabAccountContent" style="display: block;">
        <!-- Profile Info -->
        <div class="admin-section">
          <h3>👤 Informations du compte</h3>
          <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
            <div style="display: grid; gap: 10px;">
              <div>
                <span style="color: #888;">Email:</span>
                <span id="profileEmail" style="color: #fff; margin-left: 10px; font-weight: bold;">-</span>
              </div>
              <div>
                <span style="color: #888;">Nom d'affichage:</span>
                <span id="profileDisplayName" style="color: #fff; margin-left: 10px; font-weight: bold;">-</span>
              </div>
              <div>
                <span style="color: #888;">Abonnement:</span>
                <span id="profileTier" style="color: #00ff9d; margin-left: 10px; font-weight: bold;">-</span>
              </div>
              <div id="profileQuotas" style="color: #888; font-size: 0.9em; margin-top: 5px;">
                Chargement des quotas...
              </div>
            </div>
          </div>
        </div>

        <!-- Avatar Section -->
        <div class="admin-section">
          <h3>🖼️ Photo de profil</h3>
          <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
            <div style="display: flex; align-items: center; gap: 20px;">
              <div id="profileAvatarPreview" style="width: 80px; height: 80px; border-radius: 50%; background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary)); display: flex; align-items: center; justify-content: center; font-size: 2em; color: #fff; font-weight: bold; overflow: hidden;">
                ?
              </div>
              <div style="flex: 1;">
                <input type="file" id="avatarInput" accept="image/*" aria-label="Choisir une photo de profil" style="display: none;" onchange="handleAvatarSelection(event)">
                <button class="create-user-btn" onclick="document.getElementById('avatarInput').click()" style="margin-bottom: 10px;">
                  📷 Choisir une photo
                </button>
                <div style="color: #888; font-size: 0.85em;">
                  JPG, PNG, GIF ou WebP • Max 5MB
                </div>
                <div id="avatarMessage" class="hidden" style="margin-top: 10px;"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Update Display Name -->
        <div class="admin-section">
          <h3>✏️ Modifier le nom d'affichage</h3>
          <div id="displayNameMessage" class="hidden" style="margin-bottom: 15px;"></div>
          <form class="create-user-form" onsubmit="return false;">
            <div class="input-group" style="margin-bottom: 0;">
              <label for="newDisplayName" class="visually-hidden">Nouveau nom d'affichage</label>
              <input type="text" id="newDisplayName" placeholder="Nouveau nom d'affichage" autocomplete="name" required minlength="2" maxlength="50">
            </div>
            <button class="create-user-btn" onclick="updateDisplayName()">Mettre à jour</button>
          </form>
        </div>
      </div>

      <!-- TAB 2: MOT DE PASSE -->
      <div id="profileTabPasswordContent" style="display: none;">
        <div class="admin-section">
          <h3>🔐 Changer le mot de passe</h3>
          <div style="background: rgba(255, 193, 7, 0.1); border: 1px solid rgba(255, 193, 7, 0.3); padding: 12px; border-radius: 8px; margin-bottom: 15px; color: #ffc107; font-size: 0.9em;">
            ⚠️ <strong>Important:</strong> Changer votre mot de passe supprimera votre historique de traductions pour des raisons de sécurité (l'historique est crypté avec votre mot de passe).
          </div>
          <div id="changePasswordMessage" class="hidden" style="margin-bottom: 15px;"></div>
          <form class="create-user-form" onsubmit="return false;">
            <div class="input-group" style="margin-bottom: 0;">
              <label for="currentPassword" class="visually-hidden">Mot de passe actuel</label>
              <input type="password" id="currentPassword" placeholder="Mot de passe actuel" autocomplete="current-password" required>
            </div>
            <div class="input-group" style="margin-bottom: 0;">
              <label for="newPassword" class="visually-hidden">Nouveau mot de passe</label>
              <input type="password" id="newPassword" placeholder="Nouveau mot de passe" autocomplete="new-password" required>
            </div>
            <div class="input-group" style="margin-bottom: 0;">
              <label for="confirmNewPassword" class="visually-hidden">Confirmer le nouveau mot de passe</label>
              <input type="password" id="confirmNewPassword" placeholder="Confirmer le nouveau mot de passe" autocomplete="new-password" required>
            </div>
            <button class="create-user-btn" onclick="changePassword()">Changer le mot de passe</button>
          </form>
        </div>
      </div>

      <!-- TAB 3: HISTORIQUE -->
      <div id="profileTabHistoryContent" style="display: none;">
        <div class="admin-section">
          <h3>📜 Historique des traductions</h3>
          <div style="margin-bottom: 15px;">
            <p style="color: #888; font-size: 0.9em;">Votre historique est crypté et stocké de manière sécurisée.</p>
            <div style="display: flex; gap: 10px; margin-top: 10px;">
              <button class="create-user-btn" onclick="viewHistory()" style="margin: 0; flex: 1;">📖 Voir l'historique</button>
              <button class="create-user-btn" onclick="deleteHistory()" style="margin: 0; flex: 1; background: #ff6b6b; color: #fff;">🗑️ Supprimer l'historique</button>
            </div>
          </div>
          <div id="historyContainer" style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; max-height: 300px; overflow-y: auto; display: none;">
            <div id="historyContent"></div>
          </div>
        </div>
      </div>

      <!-- TAB 4: ZONE DANGEREUSE -->
      <div id="profileTabDangerContent" style="display: none;">
        <div class="admin-section" style="border: 2px solid #ff6b6b; border-radius: 10px; padding: 20px;">
          <h3 style="color: #ff6b6b;">⚠️ Zone dangereuse</h3>
          <p style="color: #888; font-size: 0.9em; margin-bottom: 15px;">La suppression de votre compte est irréversible. Toutes vos données seront définitivement supprimées.</p>
          <div id="deleteAccountMessage" class="hidden" style="margin-bottom: 15px;"></div>
          <form class="create-user-form" onsubmit="return false;">
            <div class="input-group" style="margin-bottom: 0;">
              <label for="deleteAccountPassword" class="visually-hidden">Confirmer avec votre mot de passe</label>
              <input type="password" id="deleteAccountPassword" placeholder="Confirmer avec votre mot de passe" autocomplete="current-password" required>
            </div>
            <button class="create-user-btn" onclick="deleteAccount()" style="background: #ff6b6b; color: #fff;">🗑️ Supprimer mon compte</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Friends Panel -->
  <div id="friendsPanel" class="admin-panel hidden">
    <div class="admin-content">
      <div class="admin-header">
        <h2>👥 Amis</h2>
        <button class="close-admin-btn" onclick="closeFriendsPanel()">✕ Fermer</button>
      </div>

      <!-- Search Users -->
      <div class="admin-section">
        <h3 id="searchUsersTitle">🔍 Rechercher des utilisateurs</h3>
        <div style="margin-bottom: 15px;">
          <p id="searchUsersDesc" style="color: #888; font-size: 0.9em; margin-bottom: 10px;">Recherchez des utilisateurs par leur nom d'affichage exact pour leur envoyer une demande d'ami.</p>
          <div style="display: flex; gap: 10px;">
            <label for="searchUserInput" class="visually-hidden">Nom d'affichage exact</label>
            <input type="text" id="searchUserInput" placeholder="Nom d'affichage exact" autocomplete="off" style="flex: 1; padding: 10px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff; font-size: 1em;">
            <button class="create-user-btn" id="searchUsersBtn" onclick="searchUsers()" style="margin: 0;">Rechercher</button>
          </div>
        </div>
        <div id="searchResults" style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; max-height: 200px; overflow-y: auto; display: none;">
          <div id="searchResultsContent"></div>
        </div>
      </div>

      <!-- Friend Requests -->
      <div class="admin-section">
        <h3>📥 Demandes d'ami reçues</h3>
        <div id="friendRequestsContainer" style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; max-height: 300px; overflow-y: auto;">
          <div id="friendRequestsContent" style="color: #888;">Chargement...</div>
        </div>
      </div>

      <!-- Friends List -->
      <div class="admin-section">
        <h3>✅ Mes amis</h3>
        <div id="friendsListContainer" style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; max-height: 400px; overflow-y: auto;">
          <div id="friendsListContent" style="color: #888;">Chargement...</div>
        </div>
      </div>
    </div>
  </div>

  <!-- New DM User Selection Modal -->
  <div id="newDMModal" class="admin-panel hidden">
    <div class="admin-content">
      <div class="admin-header">
        <h2>✉️ Nouveau message privé</h2>
        <button class="close-admin-btn" onclick="closeNewDMModal()">✕ Fermer</button>
      </div>

      <div class="admin-section">
        <h3>👥 Sélectionner un utilisateur</h3>
        <div id="userSelectionContainer" style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; max-height: 500px; overflow-y: auto;">
          <div id="userSelectionContent" style="color: #888;">Chargement...</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Direct Messages Panel -->
  <div id="dmsPanel" class="admin-panel hidden">
    <div class="admin-content">
      <div class="admin-header">
        <h2>💬 Messages privés</h2>
        <button class="close-admin-btn" onclick="closeDMsPanel()">✕ Fermer</button>
      </div>

      <!-- Conversations List -->
      <div class="admin-section">
        <h3>📋 Conversations</h3>
        <div id="dmsListContainer" style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; max-height: 500px; overflow-y: auto;">
          <div id="dmsListContent" style="color: #888;">Chargement...</div>
        </div>
      </div>

      <!-- Archived DMs -->
      <div class="admin-section">
        <h3>📦 Conversations archivées</h3>
        <button class="create-user-btn" onclick="showArchivedDMs()" style="margin-bottom: 15px;">Voir les conversations archivées</button>
        <div id="archivedDMsContainer" class="hidden" style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; max-height: 400px; overflow-y: auto;">
          <div id="archivedDMsContent" style="color: #888;">Cliquez sur le bouton ci-dessus</div>
        </div>
      </div>
    </div>
  </div>

  <!-- DM Chat Panel -->
  <div id="dmChatPanel" class="admin-panel hidden">
    <div class="admin-content" style="display: flex; flex-direction: column; height: 90vh;">
      <div class="admin-header">
        <h2 id="dmChatTitle">💬 Message</h2>
        <button class="close-admin-btn" onclick="closeDMChatPanel()">✕ Fermer</button>
      </div>

      <!-- User Info -->
      <div class="admin-section" style="flex-shrink: 0;">
        <div id="dmChatInfo" style="display: flex; justify-content: space-between; align-items: center;">
          <div style="display: flex; align-items: center; gap: 10px;">
            <div id="dmUserAvatar" style="width: 40px; height: 40px;"></div>
            <div>
              <div id="dmUserName" style="font-weight: bold; color: #fff;"></div>
              <span id="dmUserEmail" style="color: #888; font-size: 0.85em;"></span>
            </div>
          </div>
          <button id="archiveDMBtn" onclick="archiveCurrentDM()" style="margin: 0; padding: 8px 16px; font-size: 0.9em; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #fff; border-radius: 8px; cursor: pointer;">📦 Archiver</button>
        </div>
      </div>

      <!-- Messages -->
      <div class="admin-section" style="flex: 1; overflow-y: auto; padding: 15px 0; display: flex; flex-direction: column;">
        <div id="dmMessagesContent" style="flex: 1; overflow-y: auto; padding: 0 10px;">
          <p style="color: #888; text-align: center;">Aucun message</p>
        </div>

        <!-- Typing Indicator -->
        <div id="dmTypingIndicator" style="display: none; padding: 10px; color: #888; font-size: 0.9em; font-style: italic;">
          <span id="dmTypingIndicatorText"></span><span class="typing-dots"></span>
        </div>
      </div>

      <!-- Message Input -->
      <div class="admin-section" style="flex-shrink: 0;">
        <div style="display: flex; gap: 10px; align-items: stretch;">
          <input type="file" id="dmFileInput" accept="image/*,.pdf,.doc,.docx,.txt,.mp3,.mp4,.webm,.ogg" aria-label="Sélectionner un fichier" style="display: none;" onchange="handleDMFileSelection(event)">
          <button id="dmFileBtn" class="create-user-btn" onclick="document.getElementById('dmFileInput').click()" style="margin: 0; padding: 12px 16px; background: #4CAF50; min-width: 60px; display: flex; align-items: center; justify-content: center; font-size: 1.2em;" title="Partager un fichier">
            📎
          </button>
          <label for="dmMessageInput" class="visually-hidden">Tapez votre message</label>
          <input type="text" id="dmMessageInput" placeholder="Tapez votre message..." autocomplete="off" style="flex: 1; padding: 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff; font-size: 1em;" onkeypress="if(event.key === 'Enter') sendDM()" oninput="handleDMTyping()">
          <button class="create-user-btn" id="dmSendBtn" onclick="sendDM()" style="margin: 0; padding: 12px 24px;">Envoyer</button>
        </div>

        <!-- File Preview Area for DM -->
        <div id="dmFilePreviewArea" style="display: none; margin-top: 10px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; border: 1px solid rgba(255,255,255,0.2);">
          <div style="display: flex; align-items: center; gap: 10px;">
            <span id="dmFilePreviewName" style="flex: 1; color: #fff;"></span>
            <button onclick="cancelDMFileSelection()" style="background: #ff6b6b; border: none; border-radius: 4px; padding: 4px 8px; color: #fff; cursor: pointer;">✕</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Groups Panel -->
  <div id="groupsPanel" class="admin-panel hidden">
    <div class="admin-content">
      <div class="admin-header">
        <h2>💬 Groupes de discussion</h2>
        <button class="close-admin-btn" onclick="closeGroupsPanel()">✕ Fermer</button>
      </div>

      <!-- Create Group -->
      <div class="admin-section">
        <h3>➕ Créer un groupe</h3>
        <div id="createGroupMessage" class="hidden" style="margin-bottom: 15px;"></div>
        <form class="create-user-form" onsubmit="return false;">
          <div class="input-group" style="margin-bottom: 0;">
            <label for="groupName" class="visually-hidden">Nom du groupe</label>
            <input type="text" id="groupName" placeholder="Nom du groupe" autocomplete="off" required minlength="2" maxlength="50">
          </div>
          <div style="margin: 15px 0;">
            <label style="color: #888; font-size: 0.9em; display: block; margin-bottom: 10px;">Visibilité du groupe:</label>
            <div style="display: flex; gap: 20px; margin-bottom: 15px;">
              <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                <input type="radio" name="groupVisibility" value="private" checked>
                <span>🔒 Privé (sur invitation seulement)</span>
              </label>
              <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                <input type="radio" name="groupVisibility" value="public">
                <span>🌐 Public (tout le monde peut rejoindre)</span>
              </label>
            </div>
          </div>
          <div style="margin: 15px 0;">
            <label style="color: #888; font-size: 0.9em; display: block; margin-bottom: 10px;">Sélectionner des amis à ajouter:</label>
            <div id="friendsSelectionList" style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; max-height: 200px; overflow-y: auto;">
              <p style="color: #888;">Chargement de vos amis...</p>
            </div>
          </div>
          <button class="create-user-btn" onclick="createGroup()">Créer le groupe</button>
        </form>
      </div>

      <!-- My Groups -->
      <div class="admin-section">
        <h3>📋 Mes groupes</h3>
        <div id="groupsListContainer" style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; max-height: 400px; overflow-y: auto;">
          <div id="groupsListContent" style="color: #888;">Chargement...</div>
        </div>
      </div>

      <!-- Public Groups -->
      <div class="admin-section">
        <h3>🌐 Groupes publics</h3>
        <button class="create-user-btn" onclick="browsePublicGroups()" style="margin-bottom: 15px;">Parcourir les groupes publics</button>
        <div id="publicGroupsContainer" class="hidden" style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; max-height: 400px; overflow-y: auto;">
          <div id="publicGroupsContent" style="color: #888;">Cliquez sur le bouton ci-dessus pour voir les groupes publics</div>
        </div>
      </div>

      <!-- Archived Groups -->
      <div class="admin-section">
        <h3>📦 Groupes archivés</h3>
        <button class="create-user-btn" onclick="showArchivedGroups()" style="margin-bottom: 15px;">Voir les groupes archivés</button>
        <div id="archivedGroupsContainer" class="hidden" style="background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; max-height: 400px; overflow-y: auto;">
          <div id="archivedGroupsContent" style="color: #888;">Cliquez sur le bouton ci-dessus pour voir les groupes archivés</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Group Chat Panel -->
  <div id="groupChatPanel" class="admin-panel hidden">
    <div class="admin-content" style="display: flex; flex-direction: column; height: 90vh;">
      <div class="admin-header">
        <h2 id="groupChatTitle">💬 Groupe</h2>
        <button class="close-admin-btn" onclick="closeGroupChatPanel()">✕ Fermer</button>
      </div>

      <!-- Group Info -->
      <div class="admin-section" style="flex-shrink: 0;">
        <div id="groupChatInfo" style="display: flex; justify-content: space-between; align-items: center;">
          <div>
            <span id="groupMembersCount" style="color: #888; font-size: 0.9em;">-</span>
          </div>
          <div style="display: flex; gap: 10px;">
            <button onclick="archiveGroup(currentChatGroupId)" style="margin: 0; padding: 8px 16px; font-size: 0.9em; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #fff; border-radius: 8px; cursor: pointer;">📦 Archiver</button>
            <button class="create-user-btn" onclick="showGroupDetails()" style="margin: 0; padding: 8px 16px; font-size: 0.9em;">⚙️ Détails</button>
          </div>
        </div>
      </div>

      <!-- Search Bar -->
      <div class="admin-section" style="flex-shrink: 0; padding: 10px 0;">
        <div style="display: flex; gap: 10px; align-items: center;">
          <label for="chatSearchInput" class="visually-hidden">Rechercher dans les messages</label>
          <input type="text" id="chatSearchInput" placeholder="🔍 Rechercher dans les messages..." autocomplete="off" style="flex: 1; padding: 10px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff; font-size: 0.9em;" oninput="searchMessages()">
          <button id="clearSearchBtn" onclick="clearSearch()" style="display: none; background: rgba(255,107,107,0.2); border: 1px solid #ff6b6b; color: #ff6b6b; padding: 10px 16px; border-radius: 8px; cursor: pointer; font-size: 0.9em;">✕</button>
          <span id="searchResultsCount" style="color: #888; font-size: 0.85em; white-space: nowrap; display: none;"></span>
        </div>
      </div>

      <!-- Messages Container -->
      <div class="admin-section" style="flex: 1; display: flex; flex-direction: column; overflow: hidden;">
        <div id="chatMessages" style="flex: 1; overflow-y: auto; background: rgba(0,0,0,0.3); border-radius: 10px; padding: 15px; margin-bottom: 15px;">
          <div id="chatMessagesContent"></div>
          <!-- Indicateur "en train d'écrire..." -->
          <div id="typingIndicator" style="display: none; padding: 8px 12px; margin-top: 10px; color: #888; font-size: 0.9em; font-style: italic;">
            <span id="typingIndicatorText"></span><span class="typing-dots"></span>
          </div>
        </div>

        <!-- Message Input -->
        <div style="display: flex; gap: 10px; align-items: stretch;">
          <input type="file" id="chatFileInput" accept="image/*,.pdf,.doc,.docx,.txt,.mp3,.mp4,.webm,.ogg" aria-label="Sélectionner un fichier" style="display: none;" onchange="handleFileSelection(event)">
          <button id="chatFileBtn" class="create-user-btn" onclick="document.getElementById('chatFileInput').click()" style="margin: 0; padding: 12px 16px; background: #4CAF50; min-width: 60px; display: flex; align-items: center; justify-content: center; font-size: 1.2em;" title="Partager un fichier">
            📎
          </button>
          <button id="chatPttBtn" class="create-user-btn" onmousedown="startChatPTT()" onmouseup="stopChatPTT()" ontouchstart="startChatPTT(event)" ontouchend="stopChatPTT(event)" style="margin: 0; padding: 12px 16px; background: #ff6b6b; min-width: 60px; display: flex; align-items: center; justify-content: center; font-size: 1.2em;">
            🎤
          </button>
          <label for="chatMessageInput" class="visually-hidden">Tapez votre message</label>
          <input type="text" id="chatMessageInput" placeholder="Tapez votre message..." autocomplete="off" style="flex: 1; padding: 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 8px; color: #fff; font-size: 1em;" onkeypress="if(event.key === 'Enter') sendMessage()">
          <button class="create-user-btn" id="chatSendBtn" onclick="sendMessage()" style="margin: 0; padding: 12px 24px;">Envoyer</button>
        </div>

        <!-- File Preview Area -->
        <div id="filePreviewArea" style="display: none; margin-top: 10px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 8px; border: 1px solid rgba(255,255,255,0.2);">
          <div style="display: flex; align-items: center; gap: 10px;">
            <span id="filePreviewName" style="flex: 1; color: #fff;"></span>
            <button onclick="cancelFileSelection()" style="background: #ff6b6b; border: none; border-radius: 4px; padding: 4px 8px; color: #fff; cursor: pointer;">✕</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ES6 Modules (charge les utilitaires, config, thèmes, notifications) -->
  <script type="module" src="js/main.js"></script>

  <!-- Application principale (legacy - migration progressive) -->
  <!-- Note: defer garantit que app.js s'exécute après le parsing HTML -->
  <script defer src="app.js"></script>
</body>
</html>
